<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Development Workflow | Delivering Data Science Products via Packages</title>
  <meta name="description" content="Creating R and Python packages to scale data science." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Development Workflow | Delivering Data Science Products via Packages" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Creating R and Python packages to scale data science." />
  <meta name="github-repo" content="bradleyboehmke/misk-packages" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Development Workflow | Delivering Data Science Products via Packages" />
  
  <meta name="twitter:description" content="Creating R and Python packages to scale data science." />
  



<meta name="date" content="2020-06-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="structure.html"/>
<link rel="next" href="metadata.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Creating Packages</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who-should-read-this"><i class="fa fa-check"></i>Who should read this</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-you-need-for-this-book"><i class="fa fa-check"></i>What you need for this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#conventions-used-in-this-book"><i class="fa fa-check"></i>Conventions used in this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#feedback"><i class="fa fa-check"></i>Feedback</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="part"><span><b>I Getting Started</b></span></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to Packaging</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#why-is-packaging-important"><i class="fa fa-check"></i><b>2.1</b> Why is packaging important</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#when-packaging-might-not-be-needed"><i class="fa fa-check"></i><b>2.2</b> When packaging might not be needed</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#an-opinionated-approach"><i class="fa fa-check"></i><b>2.3</b> An opinionated approach</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="structure.html"><a href="structure.html"><i class="fa fa-check"></i><b>3</b> Package Structure</a><ul>
<li class="chapter" data-level="3.1" data-path="structure.html"><a href="structure.html#example"><i class="fa fa-check"></i><b>3.1</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> example</a></li>
<li class="chapter" data-level="3.2" data-path="structure.html"><a href="structure.html#example-1"><i class="fa fa-check"></i><b>3.2</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> example</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="workflow.html"><a href="workflow.html"><i class="fa fa-check"></i><b>4</b> Development Workflow</a><ul>
<li class="chapter" data-level="4.1" data-path="workflow.html"><a href="workflow.html#create-the-package"><i class="fa fa-check"></i><b>4.1</b> Create the package</a><ul>
<li class="chapter" data-level="4.1.1" data-path="workflow.html"><a href="workflow.html#naming"><i class="fa fa-check"></i><b>4.1.1</b> Naming</a></li>
<li class="chapter" data-level="4.1.2" data-path="workflow.html"><a href="workflow.html#create"><i class="fa fa-check"></i><b>4.1.2</b> Create</a></li>
<li class="chapter" data-level="4.1.3" data-path="workflow.html"><a href="workflow.html#version-control"><i class="fa fa-check"></i><b>4.1.3</b> Version control</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="workflow.html"><a href="workflow.html#setup-a-virtual-environment"><i class="fa fa-check"></i><b>4.2</b> Setup a virtual environment</a></li>
<li class="chapter" data-level="4.3" data-path="workflow.html"><a href="workflow.html#add-new-functionality"><i class="fa fa-check"></i><b>4.3</b> Add new functionality</a></li>
<li class="chapter" data-level="4.4" data-path="workflow.html"><a href="workflow.html#document"><i class="fa fa-check"></i><b>4.4</b> Document</a></li>
<li class="chapter" data-level="4.5" data-path="workflow.html"><a href="workflow.html#version-control-1"><i class="fa fa-check"></i><b>4.5</b> Version control</a></li>
<li class="chapter" data-level="4.6" data-path="workflow.html"><a href="workflow.html#example-2"><i class="fa fa-check"></i><b>4.6</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> example</a><ul>
<li class="chapter" data-level="4.6.1" data-path="workflow.html"><a href="workflow.html#step-1-check-package-name"><i class="fa fa-check"></i><b>4.6.1</b> Step 1: Check package name</a></li>
<li class="chapter" data-level="4.6.2" data-path="workflow.html"><a href="workflow.html#step-2-create-package-directory-and-structure"><i class="fa fa-check"></i><b>4.6.2</b> Step 2: Create package directory and structure</a></li>
<li class="chapter" data-level="4.6.3" data-path="workflow.html"><a href="workflow.html#step-3-version-control"><i class="fa fa-check"></i><b>4.6.3</b> Step 3: Version control</a></li>
<li class="chapter" data-level="4.6.4" data-path="workflow.html"><a href="workflow.html#step-4-setup-virtual-environment"><i class="fa fa-check"></i><b>4.6.4</b> Step 4: Setup virtual environment</a></li>
<li class="chapter" data-level="4.6.5" data-path="workflow.html"><a href="workflow.html#step-5-add-new-functionality"><i class="fa fa-check"></i><b>4.6.5</b> Step 5: Add new functionality</a></li>
<li class="chapter" data-level="4.6.6" data-path="workflow.html"><a href="workflow.html#step-6-document"><i class="fa fa-check"></i><b>4.6.6</b> Step 6: Document</a></li>
<li class="chapter" data-level="4.6.7" data-path="workflow.html"><a href="workflow.html#step-8-version-control"><i class="fa fa-check"></i><b>4.6.7</b> Step 8: Version control</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="workflow.html"><a href="workflow.html#example-3"><i class="fa fa-check"></i><b>4.7</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> example</a><ul>
<li class="chapter" data-level="4.7.1" data-path="workflow.html"><a href="workflow.html#step-1-check-package-name-1"><i class="fa fa-check"></i><b>4.7.1</b> Step 1: Check package name</a></li>
<li class="chapter" data-level="4.7.2" data-path="workflow.html"><a href="workflow.html#step-2-create-package-directory-and-structure-1"><i class="fa fa-check"></i><b>4.7.2</b> Step 2: Create package directory and structure</a></li>
<li class="chapter" data-level="4.7.3" data-path="workflow.html"><a href="workflow.html#step-3-version-control-1"><i class="fa fa-check"></i><b>4.7.3</b> Step 3: Version control</a></li>
<li class="chapter" data-level="4.7.4" data-path="workflow.html"><a href="workflow.html#step-4-setup-virtual-environment-1"><i class="fa fa-check"></i><b>4.7.4</b> Step 4: Setup virtual environment</a></li>
<li class="chapter" data-level="4.7.5" data-path="workflow.html"><a href="workflow.html#step-5-add-new-functionality-1"><i class="fa fa-check"></i><b>4.7.5</b> Step 5: Add new functionality</a></li>
<li class="chapter" data-level="4.7.6" data-path="workflow.html"><a href="workflow.html#step-6-document-1"><i class="fa fa-check"></i><b>4.7.6</b> Step 6: Document</a></li>
<li class="chapter" data-level="4.7.7" data-path="workflow.html"><a href="workflow.html#step-7-version-control"><i class="fa fa-check"></i><b>4.7.7</b> Step 7: Version control</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Package Components</b></span></li>
<li class="chapter" data-level="5" data-path="metadata.html"><a href="metadata.html"><i class="fa fa-check"></i><b>5</b> Package Metadata</a><ul>
<li class="chapter" data-level="5.1" data-path="metadata.html"><a href="metadata.html#name-and-package-description"><i class="fa fa-check"></i><b>5.1</b> Name and package description</a></li>
<li class="chapter" data-level="5.2" data-path="metadata.html"><a href="metadata.html#author-and-contact-info"><i class="fa fa-check"></i><b>5.2</b> Author and contact info</a></li>
<li class="chapter" data-level="5.3" data-path="metadata.html"><a href="metadata.html#dependencies"><i class="fa fa-check"></i><b>5.3</b> Dependencies</a></li>
<li class="chapter" data-level="5.4" data-path="metadata.html"><a href="metadata.html#versioning"><i class="fa fa-check"></i><b>5.4</b> Versioning</a></li>
<li class="chapter" data-level="5.5" data-path="metadata.html"><a href="metadata.html#license"><i class="fa fa-check"></i><b>5.5</b> License</a></li>
<li class="chapter" data-level="5.6" data-path="metadata.html"><a href="metadata.html#project-source"><i class="fa fa-check"></i><b>5.6</b> Project source</a></li>
<li class="chapter" data-level="5.7" data-path="metadata.html"><a href="metadata.html#other"><i class="fa fa-check"></i><b>5.7</b> Other</a></li>
<li class="chapter" data-level="5.8" data-path="metadata.html"><a href="metadata.html#example-4"><i class="fa fa-check"></i><b>5.8</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> example</a><ul>
<li class="chapter" data-level="5.8.1" data-path="metadata.html"><a href="metadata.html#dependencies-1"><i class="fa fa-check"></i><b>5.8.1</b> Dependencies</a></li>
<li class="chapter" data-level="5.8.2" data-path="metadata.html"><a href="metadata.html#exercises"><i class="fa fa-check"></i><b>5.8.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="metadata.html"><a href="metadata.html#example-5"><i class="fa fa-check"></i><b>5.9</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> example</a><ul>
<li class="chapter" data-level="5.9.1" data-path="metadata.html"><a href="metadata.html#dependencies-2"><i class="fa fa-check"></i><b>5.9.1</b> Dependencies</a></li>
<li class="chapter" data-level="5.9.2" data-path="metadata.html"><a href="metadata.html#exercises-1"><i class="fa fa-check"></i><b>5.9.2</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="code.html"><a href="code.html"><i class="fa fa-check"></i><b>6</b> Source Code</a><ul>
<li class="chapter" data-level="6.1" data-path="code.html"><a href="code.html#organization"><i class="fa fa-check"></i><b>6.1</b> Organization</a><ul>
<li class="chapter" data-level="6.1.1" data-path="code.html"><a href="code.html#individual-units"><i class="fa fa-check"></i><b>6.1.1</b> Individual units</a></li>
<li class="chapter" data-level="6.1.2" data-path="code.html"><a href="code.html#expanding-code-breadth"><i class="fa fa-check"></i><b>6.1.2</b> Expanding code breadth</a></li>
<li class="chapter" data-level="6.1.3" data-path="code.html"><a href="code.html#aggregating-functionality"><i class="fa fa-check"></i><b>6.1.3</b> Aggregating functionality</a></li>
<li class="chapter" data-level="6.1.4" data-path="code.html"><a href="code.html#naming-is-important"><i class="fa fa-check"></i><b>6.1.4</b> Naming is important</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="code.html"><a href="code.html#external-vs-internal"><i class="fa fa-check"></i><b>6.2</b> External vs internal</a></li>
<li class="chapter" data-level="6.3" data-path="code.html"><a href="code.html#example-6"><i class="fa fa-check"></i><b>6.3</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> example</a><ul>
<li class="chapter" data-level="6.3.1" data-path="code.html"><a href="code.html#setup"><i class="fa fa-check"></i><b>6.3.1</b> Setup</a></li>
<li class="chapter" data-level="6.3.2" data-path="code.html"><a href="code.html#internal-function"><i class="fa fa-check"></i><b>6.3.2</b> Internal function</a></li>
<li class="chapter" data-level="6.3.3" data-path="code.html"><a href="code.html#adding-breadth"><i class="fa fa-check"></i><b>6.3.3</b> Adding breadth</a></li>
<li class="chapter" data-level="6.3.4" data-path="code.html"><a href="code.html#adding-aggregation"><i class="fa fa-check"></i><b>6.3.4</b> Adding aggregation</a></li>
<li class="chapter" data-level="6.3.5" data-path="code.html"><a href="code.html#final-checks-version-control"><i class="fa fa-check"></i><b>6.3.5</b> Final checks &amp; version control</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="code.html"><a href="code.html#example-7"><i class="fa fa-check"></i><b>6.4</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> example</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="test.html"><a href="test.html"><i class="fa fa-check"></i><b>7</b> Testing</a><ul>
<li class="chapter" data-level="7.1" data-path="test.html"><a href="test.html#section"><i class="fa fa-check"></i><b>7.1</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg></a></li>
<li class="chapter" data-level="7.2" data-path="test.html"><a href="test.html#section-1"><i class="fa fa-check"></i><b>7.2</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="object-docs.html"><a href="object-docs.html"><i class="fa fa-check"></i><b>8</b> Object Documentation</a><ul>
<li class="chapter" data-level="8.1" data-path="object-docs.html"><a href="object-docs.html#section-2"><i class="fa fa-check"></i><b>8.1</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg></a></li>
<li class="chapter" data-level="8.2" data-path="object-docs.html"><a href="object-docs.html#section-3"><i class="fa fa-check"></i><b>8.2</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="changelog.html"><a href="changelog.html"><i class="fa fa-check"></i><b>9</b> Changelog</a></li>
<li class="chapter" data-level="10" data-path="readme.html"><a href="readme.html"><i class="fa fa-check"></i><b>10</b> README</a></li>
<li class="chapter" data-level="11" data-path="website.html"><a href="website.html"><i class="fa fa-check"></i><b>11</b> Package Website</a></li>
<li class="chapter" data-level="12" data-path="metadata.html"><a href="metadata.html#other"><i class="fa fa-check"></i><b>12</b> Other Components</a></li>
<li class="part"><span><b>III Continuous Integration &amp; Deployment</b></span></li>
<li class="chapter" data-level="13" data-path="tbd.html"><a href="tbd.html"><i class="fa fa-check"></i><b>13</b> TBD</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Delivering Data Science Products via Packages</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="workflow" class="section level1">
<h1><span class="header-section-number">4</span> Development Workflow</h1>
<p>As data scientists, we get used to common workflows that exist in exploring and modeling data. However, the package development workflow is often unique from how we are used to working. This chapter is designed to get you started on a small package so you can experience the typical workflow. First, we’ll discuss the common steps and then we will work through them for both an <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> and <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> version of the package.</p>
<div id="create-the-package" class="section level2">
<h2><span class="header-section-number">4.1</span> Create the package</h2>
<p>Once you have determined the need to create a package, the first thing we need to do is identify a package name, create the basic package structure, and connect it to a version control system (i.e. Github) of interest.</p>
<div id="naming" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Naming</h3>
<p>Naming our package is important. There are certain requirements we need to adhere to but, also, the name you choose should be easy to remember and follow the respective languages idiomatic approach to naming. Moreover, the name you choose should not already exist.</p>
<svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512">
<path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/>
</svg>
<p>and <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> have slightly different requirements regarding acceptable names. In both languages, you can only use letters and numbers; however, you can’t start the name with a number. In <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> your name can contain a <code>.</code> but not a <code>-</code> or <code>_</code> while in <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> your name can contain all three. In both languages you can combine upper and lowercase letters in the name.</p>
<p>However, our advice is to keep the name short, all lowercase, and with no separator when possible. Examples of good approaches to name include:</p>
<ul>
<li>numpy</li>
<li>dplyr</li>
<li>pandas</li>
<li>keras</li>
</ul>
<p>Once you’ve come up with a name or two you probably want to make sure that the name is not already being used. The package managers (CRAN &amp; PyPI) do not allow duplicate names so your name must be unique. Even if you don’t intend to share your package publicly, you should avoid duplicate names if possible. Both <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> and <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> have tools that make this easy to do and we’ll cover them in the hands-on sections of this chapter.</p>
</div>
<div id="create" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Create</h3>
<p>Once you have a name its time to create the package. This includes determining where the package will live on your operating system and creating the bare bones framework of the package.</p>
<p>When creating a package, the source code location (path) refers to where the <strong>source</strong> lives, not where the <strong>installed</strong> form lives. Recall in Chapter <a href="intro.html#intro">2</a> that installed packages all live within a library directory. But when developing, you will keep the source code somewhere else.</p>
<p>Where should you keep source packages? The main principle is that this location should be distinct from where installed packages live. In the absence of external considerations, a typical user should designate a directory inside their home directory for <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> and <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> (source) packages. This may be in directories such as <code>~/Desktop/Packages/</code> or <code>/r/packages</code> and <code>/python/packages</code>. Some of us use one directory for this, others divide source packages among a few directories. This probably reflects that we are primarily tool-builders. An academic researcher might organize their files around individual publications, whereas a data scientist might organize around data products and reports. There is no particular technical or traditional reason for one specific approach. As long as you keep a clear distinction between source and installed packages, just pick a strategy that works within your overall system for file organization, and use it consistently.</p>
<p>Once you have a location to hold the source code, both <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> and <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> have tools that help to automate the creation of a basic package structure. We’ll use these tools in the hands-on sections of this chapter.</p>
</div>
<div id="version-control" class="section level3">
<h3><span class="header-section-number">4.1.3</span> Version control</h3>
<p>Most package development never resides solely on one operating system nor with only one developer. So not only should we be using git for version control, we should be using a hosting platform such as <a href="https://github.com/">GitHub</a>, <a href="https://gitlab.com/">GitLab</a>, <a href="https://azure.microsoft.com/en-us/services/devops/repos/">Azure Repos</a>, or the like. So the first thing we need to do is connect our local git repository to a remote repository so we can push, pull, and merge updates we make to the package.</p>
<p>Once we have established our remote repository, we should set up a proper branching method for our work. We advise a Git flow branching strategy where:</p>
<ul>
<li><strong>master</strong> branch is the “production” release branch. This is the main branch where the source code always reflects a production-ready state.</li>
<li><strong>develop</strong> branch is the main branch where the source code always reflects a state with the latest delivered development changes for the next release. Some would call this the “integration branch”.</li>
<li><strong>supporting branches</strong> are the branches where we do the majority of our work. These are the branches where we create new fixtures, fix bugs, improve documentation.</li>
</ul>
<p>In this branching approach, we will make updates to our package in a supporting branch, then do a pull request to merge these updates into the develop branch. Once the develop branch has enough updates to warrant a new release we then merge the develop to master with a pull request.</p>
<div class="note">
<p>
This may seem like a lot to digest and it may seem like overkill when working on our own small prototype packages. However, this is how larger projects should be organized so adopting this approach now will make it easier when you start working on larger, group projects/packages. If you are unfamiliar with git and branching then we recommend these tutorials to get started:
</p>
<ul>
<li>
<a href="https://guides.github.com/introduction/flow/">Understanding the GitHub flow</a>
</li>
<li>
<a href="https://nvie.com/posts/a-successful-git-branching-model/">A successful Git branching model</a>
</li>
</ul>
</div>
<p>In the hands-on sections of this chapter we’ll walk through setting up this git flow branching strategy.</p>
</div>
</div>
<div id="setup-a-virtual-environment" class="section level2">
<h2><span class="header-section-number">4.2</span> Setup a virtual environment</h2>
<p>By default, every project on your system will use the same library directory to store and retrieve packages. At first glance, this may not seem like a big deal but it does matter when different projects require different versions of dependency packages.</p>
<p>Consider the following scenario where you have two projects: <strong>Project A</strong> and <strong>Project B</strong>, both of which have a dependency on the same library, <strong>somepkg</strong>. The problem becomes apparent when we start requiring different versions of <strong>somepkg</strong>. Maybe <strong>Project A</strong> needs v1.0.0, while <strong>Project B</strong> requires the newer v2.0.0, for example.</p>
<p>This is a real problem for both <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> and <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> since they can’t differentiate between versions in the library directory. So both v1.0.0 and v2.0.0 would reside in the same directory with the same name. Since packages are stored according to just their name, there is no differentiation between versions. Thus, both <strong>Project A</strong> and <strong>Project B</strong> would be required to use the same version, which is unacceptable in many cases.</p>
<p>This is where virtual environments come into play. Virtual environments create an isolated environment for our project. This means that each project can have its own dependencies, regardless of what dependencies every other project has. This creates better reliability during the development process.</p>
<p>In the hands-on sections of this chapter, we’ll setup <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> and <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> virtual environments. We consider it a best practice to always do your development work in virtual environments.</p>
<div class="tip">
<p>
To learn more about virtual environments we suggest starting with the following tutorials:
</p>
<ul>
<li>
<a href="https://realpython.com/python-virtual-environments-a-primer/">Python Virtual Environments: A Primer</a>
</li>
<li>
<a href="https://rstudio.github.io/renv/articles/renv.html">renv: Project Environments for R</a>
</li>
</ul>
</div>
</div>
<div id="add-new-functionality" class="section level2">
<h2><span class="header-section-number">4.3</span> Add new functionality</h2>
<p>So we finally have our project set-up ready, now it’s time to start adding some functionality. When adding new functionality or fixing a bug, it’s important to approach it strategically. Rather than just adding or changing code, we should do it in a way that we know whether our code is successful or not. To accomplish this, we should use a <a href="https://en.wikipedia.org/wiki/Test-driven_development">test-driven development</a> (TDD) approach.</p>
<p>The general idea behind TDD is to follow this basic approach:</p>
<ol style="list-style-type: decimal">
<li><strong>Add a test</strong>: In TDD, each new feature or bug fix begins with writing a test. This test defines a function, improvements of a function, or a case in which a function results in a bug.</li>
<li><strong>Run test(s) and make sure the new test fails</strong>: Before writing any source code, run the new test to ensure that it fails.</li>
<li><strong>Write the code</strong>: The next step is to write some code that causes the test to pass. The new code written at this stage is not perfect and may, for example, pass the test in an inelegant way. That is acceptable because it will be improved and honed in Step 5.</li>
<li><strong>Run tests</strong>: If all test cases now pass, the programmer can be confident that the new code meets the test requirements, and does not break or degrade any existing features. If they do not, the new code must be adjusted until they do.</li>
<li><strong>Refactor code</strong>: Once the source code passes the test, you should spend time refactoring and cleaning it up. A growing code base can quickly get out of control. This step ensures you take the time to reduce <a href="https://en.wikipedia.org/wiki/Technical_debt">tech debt</a>.</li>
<li><strong>Repeat</strong>: Starting with another new test, the cycle is then repeated to push forward the functionality of the source code.</li>
</ol>
<p>This may seem like a lot of steps to remember but this process is rather quick and each step takes very small incremental steps forward. After implementing a few features in this manner it quickly becomes a natural approach to software development.</p>
<div class="tip">
<p>
If you are interested in learning more about the TDD philosophy we recommend the following books:
</p>
<ul>
<li>
<a href="https://www.amazon.com/Pragmatic-Programmer-journey-mastery-Anniversary/dp/0135957052/ref=dp_ob_title_bk">The Pragramatic Programmer</a> (Ch. 41)
</li>
<li>
<a href="https://www.amazon.com/Clean-Code-Handbook-Software-Craftsmanship/dp/0132350882/ref=pd_bxgy_img_2/134-3713013-8748161?_encoding=UTF8&amp;pd_rd_i=0132350882&amp;pd_rd_r=c66a8eb8-13a3-4246-bf5c-47bff29f3be6&amp;pd_rd_w=m2kCB&amp;pd_rd_wg=NqeJv&amp;pf_rd_p=4e3f7fc3-00c8-46a6-a4db-8457e6319578&amp;pf_rd_r=R46745MCZ1C0V1ZD3QS4&amp;psc=1&amp;refRID=R46745MCZ1C0V1ZD3QS4">Clean Code</a> (Ch. 9)
</li>
<li>
<a href="https://www.amazon.com/Test-Driven-Development-Kent-Beck/dp/0321146530">Test Driven Development</a>
</li>
</ul>
</div>
</div>
<div id="document" class="section level2">
<h2><span class="header-section-number">4.4</span> Document</h2>
<p>Once your new functionality is successfully passing tests and has been refactored, you should make sure any necessary documentation is added or updated. This will include function specific documentation, module level documentation, any code in example notebooks or vignettes and the like.</p>
</div>
<div id="version-control-1" class="section level2">
<h2><span class="header-section-number">4.5</span> Version control</h2>
<p>Lastly, we need to now save our work to our remote repository. This typically includes staging, commiting and pushing our changes. Depending on the stage of our work we may be ready to do a pull request into the main development branch.</p>
<p>Okay, so this may seem like a lot of steps to keep track of. Often, this feels more convoluted on paper than when you are actually implementing so let’s start working with an example package to go through these steps.</p>
</div>
<div id="example-2" class="section level2">
<h2><span class="header-section-number">4.6</span> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> example</h2>
<p>Let’s work through a simple example to illustrate how to perform the previous steps discussed for an <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> package. We’ll create a package that has a single function. To simplify this process we’ll just reimplement existing functionality that already exists in R…calculating the mean of a vector.</p>
<div id="step-1-check-package-name" class="section level3">
<h3><span class="header-section-number">4.6.1</span> Step 1: Check package name</h3>
<p>Although we are not going to publish this package we should still check to make sure there are no other packages that have the same name. For this example, I’m going to use the name “<strong>myfirstpkg</strong>”. We can use <code>available::available()</code> to check the availability of the name on CRAN, Bioconductor (another R package manager that is focused on biostats packages), and Github. It will even provide you hyperlinks to common websites that will let you know if this name is an existing abbreviation, wikipedia topic, or even in an urban dictionary along with any unexpected sentiment.</p>
<p>In this case, we see that there are no conflicting packages on CRAN or Bioconductor but there are on Github. This is ok in this case as I don’t expect to import and use other peoples first packages! So let’s proceed.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">available<span class="op">::</span><span class="kw">available</span>(<span class="st">&quot;myfirstpkg&quot;</span>, <span class="dt">browse =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">## Urban Dictionary can contain potentially offensive results,</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">##   should they be included? [Y]es / [N]o:</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">## ── myfirstpkg ──────────────────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">## Name valid: ✔</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">## Available on CRAN: ✔ </span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">## Available on Bioconductor: ✔</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">## Available on GitHub:  ✖ </span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">## Abbreviations: http://www.abbreviations.com/myfirstpkg</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">## Wikipedia: https://en.wikipedia.org/wiki/myfirstpkg</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">## Wiktionary: https://en.wiktionary.org/wiki/myfirstpkg</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">## Urban Dictionary:</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">##   Not found.</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">## Sentiment:???</span></a></code></pre></div>
</div>
<div id="step-2-create-package-directory-and-structure" class="section level3">
<h3><span class="header-section-number">4.6.2</span> Step 2: Create package directory and structure</h3>
<p>Now let’s create the initial package structure. There are several ways to do this but in this case I’ve set up a pre-built template that helps automate the initial structure. Open up your terminal and run:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="ex">pip</span> install cookiecutter</a></code></pre></div>
<p>Now go to the location that you want the package source code to live (i.e. a directory on your Desktop versus in a Packages subdirectory). In my case, I am going to keep this in a misk subdirectory:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="bu">cd</span> ~/Desktop/Workspace/Projects/misk</a></code></pre></div>
<p>Next, we’ll run the following command. This uses <a href="https://cookiecutter.readthedocs.io/en/1.7.2/README.html">cookiecutter</a> to create our simplified pre-built package.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="ex">cookiecutter</span> https://github.com/misk-data-science/package-template</a></code></pre></div>
<p>When you run this, you will be asked a series of questions such as your name, email, and package specific questions. For my package, I provided the following command responses:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="ex">first_name</span> [ex: John]: Brad</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="ex">last_name</span> [ex: Smith]: Boehmke</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="ex">email</span> [first.last@example.com]: bradleyboehmke@gmail.com</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="ex">github_username</span> [bradleyboehmke]: bradleyboehmke</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="ex">package_language</span> [r or python]: r</a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="ex">package_name</span> [awesome]: myfirstpkg</a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="ex">package_short_description</span> [short one-liner, ex: My first package]: My first package</a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="ex">version</span> [0.1.0]: </a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="ex">url</span> [https://github.com/bradleyboehmke/myfirstpkg]: </a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="ex">Select</span> open_source_license:</a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="ex">1</span> - MIT license</a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="ex">2</span> - BSD license</a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="ex">3</span> - ISC license</a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="ex">4</span> - Apache Software License 2.0</a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="ex">5</span> - GNU General Public License v3</a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="ex">6</span> - Not open source</a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="ex">Choose</span> from 1, 2, 3, 4, 5, 6 [1]: 5</a></code></pre></div>
<div class="warning">
<p>
The values in the brackets are the default values if you do not supply any input. For example, note how I did not enter any values for the version number or the URL. This is because 0.1.0 is nearly always a good first version number to start with. The Github URL is automatically generated so unless you choose to use a different remote the default should be a good choice.
</p>
</div>
<p>You should now have a directory with your package name in your current directory. If you use the shell command <code>ls</code> you should see <strong>myfirstpkg</strong> listed. Here is what my directory look likes:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="fu">ls</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="ex">ds-packages</span>     misk-dl         misk-homl       myfirstpkg      package-template</a></code></pre></div>
</div>
<div id="step-3-version-control" class="section level3">
<h3><span class="header-section-number">4.6.3</span> Step 3: Version control</h3>
<p>The first thing we want to do is create a remote where we’ll push our source code to (i.e. Github). In our case, we’ll use Github. First, <a href="https://help.github.com/en/articles/creating-a-new-repository">create a new repository</a> on GitHub.</p>
<p><img src="figures/repo-create.png" style="display: block; margin: auto;" /></p>
<p>To avoid errors, do not initialize the new repository with README, license, or gitignore files since our local directory already contains these files.</p>
<p><img src="figures/repo-create2.png" style="display: block; margin: auto;" /></p>
<p>Now go back to your terminal and <code>cd</code> into the source code directory.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="bu">cd</span> myfirstpkg</a></code></pre></div>
<p>Next, we initialize the local package directory as a git repo and add the remote URL. This allows changes to be tracked and when we push and pull our changes it will push and pull from the URL location. We can always verify that our remote was added with <code>git remote -v</code>:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="fu">git</span> init .</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="fu">git</span> remote add origin https://github.com/bradleyboehmke/myfirstpkg</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co"># verify remotes were added</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="fu">git</span> remote -v</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="ex">origin</span>  https://github.com/bradleyboehmke/myfirstpkg (fetch)</a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="ex">origin</span>  https://github.com/bradleyboehmke/myfirstpkg (push)</a></code></pre></div>
<p>Now let’s create our first commit so that we have a baseline (although empty) package.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="fu">git</span> add -A</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="fu">git</span> commit -m <span class="st">&quot;create initial package structure&quot;</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="fu">git</span> push --set-upstream origin master</a></code></pre></div>
<p>Now if you look at your Github repo you will see the master branch has your current directory contents.</p>
<p><img src="figures/initial-master.png" style="display: block; margin: auto;" /></p>
<p>Recall in section <a href="workflow.html#version-control">4.1.3</a> that we prefer to do development work with a <strong>support » develop » master</strong> branch framework. This has us doing work in a support branch and not the master or develop branch. Right now we only have a master branch established so let’s create a develop branch with <code>git checkout -b develop</code> and push the contents of the develop branch (which are the same as the master) to Github.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="fu">git</span> checkout -b develop</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="fu">git</span> push --set-upstream origin develop</a></code></pre></div>
<p>Now if you look at Github you’ll notice that we have two branches in our repo:</p>
<p><img src="figures/two-branches.png" style="display: block; margin: auto;" /></p>
<p>Whew 😌! We finally have our version control set up. That was a bit of work but you only need to do that once at package creation time.</p>
</div>
<div id="step-4-setup-virtual-environment" class="section level3">
<h3><span class="header-section-number">4.6.4</span> Step 4: Setup virtual environment</h3>
<p>Before we add any new functionality to our package, let’s create a virtual environment so we can keep all our package dependencies isolated to the location we are working in. Go ahead and open up the R project in the package source code location. You can do that by clicking on the <code>myfirstpkg.Rproj</code> file or from the command line with:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="ex">open</span> myfirstpkg.Rproj</a></code></pre></div>
<p>This will open the package project within RStudio, which is where we’ll do the majority of our work from here on out. We’ll use the <strong>renv</strong> package to create a virtual environment. Using <code>bare = TRUE</code> will create an empty projec library (with the exception of <strong>renv</strong>.</p>
<div class="tip">
<p>
Running <code>renv::init()</code> uses the default <code>bare = FALSE</code> which will perform an automate search throughout your directory to identify required packages and automatically install them into your environment.
</p>
</div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># install.packages(&quot;renv&quot;) # install renv if necessary</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2">renv<span class="op">::</span><span class="kw">init</span>(<span class="dt">bare =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>This will add some hidden files and a <code>renv/</code> directory to your repo. If you look inside the <code>renv/</code> directory you will see that only one package exists, the <strong>renv</strong> package. The first thing we want to do is make sure we have the <strong>devtools</strong> package installed. This is the primary dev package required for package development. Running the following will install devtools into our virtual environment.</p>
<div class="tip">
<p>
If you previously installed a package that meets the version number requested, <strong>renv</strong> is smart and does a linked cache rather than install the package completely. This means if you use the latest version of <strong>devtools</strong> in many projects you won’t be needlessly installing and storing multiples of the same version.
</p>
</div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</a></code></pre></div>
<p>Now let’s install all the initial packages that we will need. The <code>DESCRIPTION</code> file always contains a packages dependencies. By running the following, we will install all these dependencies into our environment.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">devtools<span class="op">::</span><span class="kw">install_deps</span>()</a></code></pre></div>
<p>The last thing we need to do is run <code>renv::snapshot()</code>. This saves the state of our project dependencies to a <code>renv.lock</code> file. That is, <code>renv.lock</code> holds all installed dependency packages required by your project. That way, anyone can recreate your virtual environment by running <code>renv::restore()</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">renv<span class="op">::</span><span class="kw">snapshot</span>()</a></code></pre></div>
<div class="tip">
<p>
Anytime you add a new dependency package make sure you run <code>renv::snapshot()</code> to update the <code>renv.lock</code> project dependency list.
</p>
</div>
</div>
<div id="step-5-add-new-functionality" class="section level3">
<h3><span class="header-section-number">4.6.5</span> Step 5: Add new functionality</h3>
<p>Now that our virtual environment is set up, let’s add some functionality to our package. The first thing we’ll add is a function that computes the mean of a vector. Recall that when we add new functionality we:</p>
<ol style="list-style-type: decimal">
<li>create a new branch to do the work in,</li>
<li>create a test that initially fails,</li>
<li>write the code to make the test pass.</li>
</ol>
<p>So first, we’ll create a new branch, which we can just call <code>add_mean</code>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="fu">git</span> checkout -b add_mean</a></code></pre></div>
<p>Now let’s create two new files:</p>
<ul>
<li><code>usethis::use_r(&quot;mean&quot;)</code>: creates a new <code>mean.R</code> file within the <code>R/</code> directory. This is where our function will be written.</li>
<li><code>usethis::use_test(&quot;mean&quot;)</code>: creates a new <code>test-mean.R</code> file within the <code>tests/testthat/</code> directory. This is where the test ensure our function is working correctly will go.</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">usethis<span class="op">::</span><span class="kw">use_r</span>(<span class="st">&quot;mean&quot;</span>)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2">usethis<span class="op">::</span><span class="kw">use_test</span>(<span class="st">&quot;mean&quot;</span>)</a></code></pre></div>
<div class="note">
<p>
Later chapters will discuss ways to organize your source code within the <code>R/</code> directory and your associated tests. For now, we’ll just create a new script for both.
</p>
</div>
<p>Now open up the <code>R/mean.R</code> file and insert a shell function. Since this function is empty it simply returns <code>NULL</code> but it will allow us to create and run a failing first test.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">my_mean &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb22-3" data-line-number="3">}</a></code></pre></div>
<p>Now open the <code>tests/testthat/test-mean.R</code> file and let’s create our first test. We can always add more tests later but for the first test we just want to check for the most basic functionality. Consequently, this test is simply testing that the mean of vector containing values 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 is 5.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">test_that</span>(<span class="st">&quot;mean of simple vectors compute accurately&quot;</span>, {</a>
<a class="sourceLine" id="cb23-2" data-line-number="2">  x &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"></a>
<a class="sourceLine" id="cb23-4" data-line-number="4">  <span class="kw">expect_equal</span>(<span class="kw">my_mean</span>(x), <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb23-5" data-line-number="5">})</a></code></pre></div>
<p>To run our test, we need to first load our package’s function (just <code>my_mean</code> for now) and then execute the test. You can do this from the RStudio console with:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">devtools<span class="op">::</span><span class="kw">load_all</span>()</a>
<a class="sourceLine" id="cb24-2" data-line-number="2">devtools<span class="op">::</span><span class="kw">test</span>()</a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="co">## ✓ |  OK F W S | Context</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="co">## x |   0 1     | mean</span></a>
<a class="sourceLine" id="cb24-5" data-line-number="5"><span class="co">## ─────────────────────────────────────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb24-6" data-line-number="6"><span class="co">## test-mean.R:4: failure: mean of simple vectors compute accurately</span></a>
<a class="sourceLine" id="cb24-7" data-line-number="7"><span class="co">## my_mean(x) not equal to 5.</span></a>
<a class="sourceLine" id="cb24-8" data-line-number="8"><span class="co">## target is NULL, current is numeric</span></a>
<a class="sourceLine" id="cb24-9" data-line-number="9"><span class="co">## ─────────────────────────────────────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb24-10" data-line-number="10"><span class="co">## </span></a>
<a class="sourceLine" id="cb24-11" data-line-number="11"><span class="co">## ══ Results ══════════════════════════════════════════════════════════════════════════</span></a>
<a class="sourceLine" id="cb24-12" data-line-number="12"><span class="co">## OK:       0</span></a>
<a class="sourceLine" id="cb24-13" data-line-number="13"><span class="co">## Failed:   1</span></a>
<a class="sourceLine" id="cb24-14" data-line-number="14"><span class="co">## Warnings: 0</span></a>
<a class="sourceLine" id="cb24-15" data-line-number="15"><span class="co">## Skipped:  0</span></a></code></pre></div>
<div class="tip">
<p>
You will find yourself doing this pattern often. The shortcut for <code>devtools::load_all()</code> is Ctrl + Shift + L (Windows &amp; Linux) or Cmd + Shift + L (macOS) and <code>devtools::test()</code> is Ctrl/Cmd + Shift + T.
</p>
</div>
<p>As you see above, our test is failing. So let’s start adding code to make this test pass. We know that the mean is computed as <span class="math inline">\(m = \frac{\text{sum of terms}}{\text{number of terms}}\)</span>. Let’s update our function to account for that:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">my_mean &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">  total &lt;-<span class="st"> </span><span class="kw">sum</span>(x)</a>
<a class="sourceLine" id="cb25-3" data-line-number="3">  units &lt;-<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">  <span class="kw">return</span>(total <span class="op">/</span><span class="st"> </span>units)</a>
<a class="sourceLine" id="cb25-5" data-line-number="5">}</a></code></pre></div>
<p>Now running our test again we get success!</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">devtools<span class="op">::</span><span class="kw">test</span>()</a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="co">## ✓ |  OK F W S | Context</span></a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="co">## ✓ |   1       | mean</span></a>
<a class="sourceLine" id="cb26-4" data-line-number="4"><span class="co">## </span></a>
<a class="sourceLine" id="cb26-5" data-line-number="5"><span class="co">## ══ Results ══════════════════════════════════════════════════════════════════════════</span></a>
<a class="sourceLine" id="cb26-6" data-line-number="6"><span class="co">## OK:       1</span></a>
<a class="sourceLine" id="cb26-7" data-line-number="7"><span class="co">## Failed:   0</span></a>
<a class="sourceLine" id="cb26-8" data-line-number="8"><span class="co">## Warnings: 0</span></a>
<a class="sourceLine" id="cb26-9" data-line-number="9"><span class="co">## Skipped:  0</span></a></code></pre></div>
<p>We likely want to iterate like this to make our function more robust. For example, what happens if a user passes non-numeric values or a non-vector data structure to our function? Or what happens if our vector contains <code>NA</code>, <code>NaN</code>, or <code>Inf</code> values? For each scenario like this we want to create a test first, make sure it fails, and then add the new functionality to our code to make our tests pass. We’ll explore this process more in chapter <a href="test.html#test">7</a>.</p>
<p>We have empirical evidence that <code>my_mean()</code> works. But how can we be sure that all the moving parts of our package still work? This may seem silly to check, after such a small addition, but it’s good to establish the habit of checking this often. <code>R CMD check</code>, executed in the shell, is the gold standard for checking that an R package is in full working order. <code>devtools::check()</code> is a convenient way to run this without leaving your R session.</p>
<div class="tip">
<p>
A shortcut for <code>devtools::check()</code> is Ctrl/Cmd + Shift + E
</p>
<p>
Also, note that this check produces rather voluminous output. The last output will list the key results and, if there are errors or warnings, it will typically point you in the right direction to resolve them.
</p>
</div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">devtools<span class="op">::</span><span class="kw">check</span>()</a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="co">## ── Building ────────────────────────────────────────────────────────────────── myfirstpkg ──</span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="co">## Setting env vars:</span></a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="co">## ● CFLAGS    : -Wall -pedantic -fdiagnostics-color=always</span></a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="co">## ● CXXFLAGS  : -Wall -pedantic -fdiagnostics-color=always</span></a>
<a class="sourceLine" id="cb27-6" data-line-number="6"><span class="co">## ● CXX11FLAGS: -Wall -pedantic -fdiagnostics-color=always</span></a>
<a class="sourceLine" id="cb27-7" data-line-number="7"><span class="co">## ────────────────────────────────────────────────────────────────────────────────────────────</span></a>
<a class="sourceLine" id="cb27-8" data-line-number="8"><span class="co">## ✓  checking for file ‘/Users/b294776/Desktop/Workspace/Projects/misk/myfirstpkg/DESCRIPTION’ ...</span></a>
<a class="sourceLine" id="cb27-9" data-line-number="9"><span class="co">## ...</span></a>
<a class="sourceLine" id="cb27-10" data-line-number="10"><span class="co">## ...</span></a>
<a class="sourceLine" id="cb27-11" data-line-number="11"><span class="co">## ── R CMD check results ─────────────────────────────────────────────── myfirstpkg 0.1.0 ────</span></a>
<a class="sourceLine" id="cb27-12" data-line-number="12"><span class="co">## Duration: 11.4s</span></a>
<a class="sourceLine" id="cb27-13" data-line-number="13"><span class="co">## </span></a>
<a class="sourceLine" id="cb27-14" data-line-number="14"><span class="co">## 0 errors ✓ | 0 warnings ✓ | 0 notes ✓</span></a></code></pre></div>
</div>
<div id="step-6-document" class="section level3">
<h3><span class="header-section-number">4.6.6</span> Step 6: Document</h3>
<p>We now have new working functionality in our package, the last thing we want to do is properly document our function. We do this with <a href="https://roxygen2.r-lib.org/"><strong>roxygen2</strong></a>, which was installed in our environment when we ran <code>devtools::install_deps()</code>. We can add object-level documentation to our <code>my_mean()</code> function like this:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="co">#&#39; Mean of a vector</span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb28-3" data-line-number="3"><span class="co">#&#39; @description </span></a>
<a class="sourceLine" id="cb28-4" data-line-number="4"><span class="co">#&#39; Computes arithmetic mean of a vector with numeric or logical values.</span></a>
<a class="sourceLine" id="cb28-5" data-line-number="5"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb28-6" data-line-number="6"><span class="co">#&#39; @param x A numeric or logical vector.</span></a>
<a class="sourceLine" id="cb28-7" data-line-number="7"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb28-8" data-line-number="8"><span class="co">#&#39; @return </span></a>
<a class="sourceLine" id="cb28-9" data-line-number="9"><span class="co">#&#39; The arithmetic mean of the values in x returned as a numeric vector of length one.</span></a>
<a class="sourceLine" id="cb28-10" data-line-number="10"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb28-11" data-line-number="11"><span class="co">#&#39; @examples</span></a>
<a class="sourceLine" id="cb28-12" data-line-number="12"><span class="co">#&#39; x &lt;- 1:10</span></a>
<a class="sourceLine" id="cb28-13" data-line-number="13"><span class="co">#&#39; my_mean(x)</span></a>
<a class="sourceLine" id="cb28-14" data-line-number="14"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb28-15" data-line-number="15"><span class="co">#&#39; @export</span></a>
<a class="sourceLine" id="cb28-16" data-line-number="16">my_mean &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb28-17" data-line-number="17">  total &lt;-<span class="st"> </span><span class="kw">sum</span>(x)</a>
<a class="sourceLine" id="cb28-18" data-line-number="18">  units &lt;-<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb28-19" data-line-number="19">  <span class="kw">return</span>(total <span class="op">/</span><span class="st"> </span>units)</a>
<a class="sourceLine" id="cb28-20" data-line-number="20">}</a></code></pre></div>
<p>After adding the documentation we can run <code>devtools::document()</code> or (Cmd/Ctrl + Shift + D):</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">devtools<span class="op">::</span><span class="kw">document</span>()</a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="co">## Updating myfirstpkg documentation</span></a>
<a class="sourceLine" id="cb29-3" data-line-number="3"><span class="co">## Loading myfirstpkg</span></a>
<a class="sourceLine" id="cb29-4" data-line-number="4"><span class="co">## Writing my_mean.Rd</span></a>
<a class="sourceLine" id="cb29-5" data-line-number="5"><span class="co">## Writing NAMESPACE</span></a>
<a class="sourceLine" id="cb29-6" data-line-number="6"><span class="co">## Documentation completed</span></a></code></pre></div>
<p>Now you can run <code>?my_mean</code> and you’ll see the help documentation show up in the RStudio window:</p>
<p><img src="figures/help-docs.png" style="display: block; margin: auto;" /></p>
<p>After adding the documentation its best to re-run the tests and R Cmd check to ensure nothing unexpected happened while adding the documentation. Later chapters will go into the details of roxygen documentation along with other documentation we should be updating along the way (i.e. NEWS.md).</p>
</div>
<div id="step-8-version-control" class="section level3">
<h3><span class="header-section-number">4.6.7</span> Step 8: Version control</h3>
<p>We now have the new functionality and documentation in place. Now we need to commit our changes, push them to Github and do a pull request to merge into the development branch of the package.</p>
<div class="tip">
<p>
Learn about writing clear and effective git messages <a href="http://udacity.github.io/git-styleguide/">here</a>.
</p>
</div>
<div class="sourceCode" id="cb30"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="fu">git</span> add -A</a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="fu">git</span> commit -m <span class="st">&quot;feat: add my_mean to compute arithmetic mean&quot;</span></a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="fu">git</span> push --set-upstream origin add_mean</a></code></pre></div>
<p>Once the changes have been pushed to Github you will notice the updated branch changes were successfully pushed. Next, select the “Compare &amp; pull request” button next to the new changes:</p>
<p><img src="figures/new-branch-then-pr.png" style="display: block; margin: auto;" /></p>
<p>Be sure to choose the “base: develop” option for the pull request. This will signal that we want to merge our changes in the the feature branch with the develop branch:</p>
<p><img src="figures/pr-into-develop.png" style="display: block; margin: auto;" /></p>
<p>Next we add a good summary of the pull request that signals what we added/changed and that we ran tests and checks successfully. After you add the message, go ahead and tag a friend or colleague to review your pull request. With more formalized projects we typically require that 1-2 folks have reviewed code changes in pull requests.</p>
<p><img src="figures/pr-msg.png" style="display: block; margin: auto;" /></p>
<p>Once all reviewers have successfully signed off on the pull request go ahead and merge it into develop.</p>
<div class="tip">
<p>
If pull requests are new to you, read more about them here:
</p>
<ul>
<li>
<a href="https://help.github.com/en/github/collaborating-with-issues-and-pull-requests">Github help docs</a>
</li>
<li>
<a href="https://www.atlassian.com/blog/git/written-unwritten-guide-pull-requests">The (written) unwritten guide to pull requests</a>
</li>
<li>
<a href="https://github.community/t/best-practices-for-pull-requests/10195">Best practices for pull requests</a>
</li>
</ul>
</div>
</div>
</div>
<div id="example-3" class="section level2">
<h2><span class="header-section-number">4.7</span> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> example</h2>
<p>Now we’ll work through a simple example to illustrate how to perform the basic workflow steps for n <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> package. As in the previous section, we’ll create a package that has a single function…calculating the mean of a vector.</p>
<div id="step-1-check-package-name-1" class="section level3">
<h3><span class="header-section-number">4.7.1</span> Step 1: Check package name</h3>
<p>Although we are not going to publish this package we should still check to make sure there are no other packages that have the same name. For this example, I’m going to use the name “<strong>myfirstpypkg</strong>”. We can use <code>pip search</code> to check the availability of the name on PyPI.</p>
<div class="warning">
<p>
If you followed along in last sections R example then make sure you use a different name.
</p>
</div>
<p>In this case, we see that there are no conflicting packages on PyPI! So let’s proceed.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="ex">pip</span> search myfirstpypkg</a></code></pre></div>
</div>
<div id="step-2-create-package-directory-and-structure-1" class="section level3">
<h3><span class="header-section-number">4.7.2</span> Step 2: Create package directory and structure</h3>
<p>Now let’s create the initial package structure. There are several ways to do this but similar to the <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> example we’ll use a pre-built template that helps automate the initial structure. Open up your terminal. If you didn’t follow along in the last section then run the following to install <a href="https://cookiecutter.readthedocs.io/en/1.7.2/README.html">cookiecutter</a>:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="ex">pip</span> install cookiecutter</a></code></pre></div>
<p>Now go to the location that you want the package source code to live (i.e. a directory on your Desktop versus in a Packages subdirectory). In my case, I am going to keep this in a misk subdirectory:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="bu">cd</span> ~/Desktop/Workspace/Projects/misk</a></code></pre></div>
<p>Next, run the following command:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="ex">cookiecutter</span> https://github.com/misk-data-science/package-template</a></code></pre></div>
<p>When you run this, you will be asked a series of questions such as your name, email, and package specific questions. For my package, I provided the following command responses:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="ex">first_name</span> [ex: John]: Brad</a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="ex">last_name</span> [ex: Smith]: Boehmke</a>
<a class="sourceLine" id="cb35-3" data-line-number="3"><span class="ex">email</span> [first.last@example.com]: bradleyboehmke@gmail.com</a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="ex">github_username</span> [bradleyboehmke]: bradleyboehmke</a>
<a class="sourceLine" id="cb35-5" data-line-number="5"><span class="ex">package_language</span> [r or python]: python</a>
<a class="sourceLine" id="cb35-6" data-line-number="6"><span class="ex">package_name</span> [awesome]: myfirstpypkg</a>
<a class="sourceLine" id="cb35-7" data-line-number="7"><span class="ex">package_short_description</span> [short one-liner, ex: My first package]: My first package</a>
<a class="sourceLine" id="cb35-8" data-line-number="8"><span class="ex">version</span> [0.1.0]: </a>
<a class="sourceLine" id="cb35-9" data-line-number="9"><span class="ex">url</span> [https://github.com/bradleyboehmke/myfirstpypkg]: </a>
<a class="sourceLine" id="cb35-10" data-line-number="10"><span class="ex">Select</span> open_source_license:</a>
<a class="sourceLine" id="cb35-11" data-line-number="11"><span class="ex">1</span> - MIT license</a>
<a class="sourceLine" id="cb35-12" data-line-number="12"><span class="ex">2</span> - BSD license</a>
<a class="sourceLine" id="cb35-13" data-line-number="13"><span class="ex">3</span> - ISC license</a>
<a class="sourceLine" id="cb35-14" data-line-number="14"><span class="ex">4</span> - Apache Software License 2.0</a>
<a class="sourceLine" id="cb35-15" data-line-number="15"><span class="ex">5</span> - GNU General Public License v3</a>
<a class="sourceLine" id="cb35-16" data-line-number="16"><span class="ex">6</span> - Not open source</a>
<a class="sourceLine" id="cb35-17" data-line-number="17"><span class="ex">Choose</span> from 1, 2, 3, 4, 5, 6 [1]: 5</a></code></pre></div>
<div class="warning">
<p>
The values in the brackets are the default values if you do not supply any input. For example, note how I did not enter any values for the version number or the URL. This is because 0.1.0 is nearly always a good first version number to start with. The Github URL is automatically generated so unless you choose to use a different remote the default should be a good choice.
</p>
</div>
<p>You should now have a directory with your package name in your current directory. If you use the shell command <code>ls</code> you should see <strong>myfirstpypkg</strong> listed. Here is what my directory look likes:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="fu">ls</span></a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="ex">ds-packages</span>     misk-dl         misk-homl       myfirstpkg      myfirstpypkg        package-template</a></code></pre></div>
</div>
<div id="step-3-version-control-1" class="section level3">
<h3><span class="header-section-number">4.7.3</span> Step 3: Version control</h3>
<p>The first thing we want to do is create a remote where we’ll push our source code to (i.e. Github). In our case, we’ll use Github. First, <a href="https://help.github.com/en/articles/creating-a-new-repository">create a new repository</a> on GitHub.</p>
<p><img src="figures/repo-create.png" style="display: block; margin: auto;" /></p>
<p>To avoid errors, do not initialize the new repository with README, license, or gitignore files since our local directory already contains these files.</p>
<p><img src="figures/create-myfirstpypkg-repo.png" style="display: block; margin: auto;" /></p>
<p>Now go back to your terminal and <code>cd</code> into the source code directory.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="bu">cd</span> myfirstpypkg</a></code></pre></div>
<p>Next, we initialize the local package directory as a git repo and add the remote URL. This allows changes to be tracked and when we push and pull our changes it will push and pull from the URL location. We can always verify that our remote was added with <code>git remote -v</code>:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="fu">git</span> init .</a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="fu">git</span> remote add origin https://github.com/bradleyboehmke/myfirstpypkg</a>
<a class="sourceLine" id="cb38-3" data-line-number="3"></a>
<a class="sourceLine" id="cb38-4" data-line-number="4"><span class="co"># verify remotes were added</span></a>
<a class="sourceLine" id="cb38-5" data-line-number="5"><span class="fu">git</span> remote -v</a>
<a class="sourceLine" id="cb38-6" data-line-number="6"><span class="ex">origin</span>  https://github.com/bradleyboehmke/myfirstpypkg (fetch)</a>
<a class="sourceLine" id="cb38-7" data-line-number="7"><span class="ex">origin</span>  https://github.com/bradleyboehmke/myfirstpypkg (push)</a></code></pre></div>
<p>Now let’s create our first commit so that we have a baseline (although empty) package.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="fu">git</span> add -A</a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="fu">git</span> commit -m <span class="st">&quot;create initial package structure&quot;</span></a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="fu">git</span> push --set-upstream origin master</a></code></pre></div>
<p>Now if you look at your Github repo you will see the master branch has your current directory contents.</p>
<p><img src="figures/intial-master-py-repo.png" style="display: block; margin: auto;" /></p>
<p>Recall in section <a href="workflow.html#version-control">4.1.3</a> that we prefer to do development work with a <strong>support » develop » master</strong> branch framework. This has us doing work in a support branch and not the master or develop branch. Right now we only have a master branch established so let’s create a develop branch with <code>git checkout -b develop</code> and push the contents of the develop branch (which are the same as the master) to Github.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="fu">git</span> checkout -b develop</a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="fu">git</span> push --set-upstream origin develop</a></code></pre></div>
<p>Now if you look at Github you’ll notice that we have two branches in our repo:</p>
<p><img src="figures/two-branches.png" style="display: block; margin: auto;" /></p>
<p>Whew 😌! We finally have our version control set up. That was a bit of work but you only need to do that once at package creation time.</p>
</div>
<div id="step-4-setup-virtual-environment-1" class="section level3">
<h3><span class="header-section-number">4.7.4</span> Step 4: Setup virtual environment</h3>
<p>Before we add any new functionality to our package, let’s create a virtual environment so we can keep all our package dependencies isolated to the location we are working in. Go ahead and open up the Python project in your favorite editor. I will be using VS Code and I can open up the project with:</p>
<div class="note">
<p>
This assumes that you have already set the project directory as the working directory.
</p>
</div>
<div class="sourceCode" id="cb41"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="ex">code</span> .</a></code></pre></div>
<p>This will open the project, which is where we’ll do the majority of our work from here on out. We’ll use the <strong>venv</strong> package to create a virtual environment. Run the following in your terminal to create and activate the virtual environment:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="ex">python</span> -m venv venv</a>
<a class="sourceLine" id="cb42-2" data-line-number="2"><span class="bu">source</span> venv/bin/activate</a></code></pre></div>
<p>This will add a <code>venv/</code> directory to your repo. If you look inside the <code>venv/</code> directory you will see a <code>lib/</code> directory that contains a couple of basic packages.</p>
<p>Now let’s install all the initial packages that we will need. The <code>setup.py</code> file contains package dependencies. By running the following, we will install all these dependencies into our environment. The <code>-e</code> installs our empty package in an __e__ditable fashion, this means as we make updates to the package we won’t need to reinstall along the way. The <code>&quot;.[dev]&quot;</code> installs all development required dependencies. We’ll cover this in chapter <a href="metadata.html#metadata">5</a>.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="ex">pip</span> install -e <span class="st">&quot;.[dev]&quot;</span></a></code></pre></div>
<div class="tip">
<p>
Whenever you are done working in your virtual environment you can run <code>deactivate</code> to exit out of your virtual environment.
</p>
</div>
</div>
<div id="step-5-add-new-functionality-1" class="section level3">
<h3><span class="header-section-number">4.7.5</span> Step 5: Add new functionality</h3>
<p>Now that our virtual environment is set up, let’s add some functionality to our package. The first thing we’ll add is a function that computes the mean of a vector. Recall that when we add new functionality we:</p>
<ol style="list-style-type: decimal">
<li>create a new branch to do the work in,</li>
<li>create a test that initially fails,</li>
<li>write the code to make the test pass.</li>
</ol>
<p>So first, we’ll create a new branch, which we can just call <code>add_mean</code>:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="fu">git</span> checkout -b add_mean</a></code></pre></div>
<p>Now let’s create two new files:</p>
<ul>
<li><code>touch src/myfirstpypkg/mean.py</code>: creates a new <code>mean.py</code> file within the source code directory. This is where our function will be written.</li>
<li><code>touch tests/test_mean.py</code>: creates a new <code>test_mean.py</code> file within the <code>tests/</code> directory. This is where the test to ensure our function is working correctly will go.</li>
</ul>
<div class="sourceCode" id="cb45"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="fu">touch</span> src/myfirstpypkg/mean.py</a>
<a class="sourceLine" id="cb45-2" data-line-number="2"><span class="fu">touch</span> tests/test_mean.py</a></code></pre></div>
<div class="note">
<p>
Later chapters will discuss ways to organize your source code within the <code>src/</code> directory and your associated tests. For now, we’ll just create a new script for both.
</p>
</div>
<p>Now open up the <code>src/myfirstpypkg/mean.py</code> file and insert a shell function. <code>pass</code> is a null operation – when it’s executed, nothing happens and consequently the function will return <code>None</code>. This allows us to create and run a failing first test.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw">def</span> my_mean(x):</a>
<a class="sourceLine" id="cb46-2" data-line-number="2">    <span class="cf">pass</span></a></code></pre></div>
<p>Now open the <code>tests/test_mean.py</code> file and let’s create our first test. We can always add more tests later but for the first test we just want to check for the most basic functionality. Consequently, this test is simply testing that the mean of values 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 is 5.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="im">from</span> myfirstpypkg.mean <span class="im">import</span> my_mean</a>
<a class="sourceLine" id="cb47-2" data-line-number="2"></a>
<a class="sourceLine" id="cb47-3" data-line-number="3"><span class="kw">def</span> test_my_mean():</a>
<a class="sourceLine" id="cb47-4" data-line-number="4">    x <span class="op">=</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">11</span>)</a>
<a class="sourceLine" id="cb47-5" data-line-number="5">    <span class="cf">assert</span> my_mean(x) <span class="op">==</span> <span class="dv">5</span></a></code></pre></div>
<p>Now we can run our tests by executing <code>pytest</code> at the command line:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="ex">pytest</span></a>
<a class="sourceLine" id="cb48-2" data-line-number="2">===================================== <span class="bu">test</span> session starts ======================================</a>
<a class="sourceLine" id="cb48-3" data-line-number="3"><span class="ex">platform</span> darwin -- Python 3.7.3, pytest-5.4.2, py-1.8.1, pluggy-0.13.1</a>
<a class="sourceLine" id="cb48-4" data-line-number="4"><span class="ex">rootdir</span>: /Users/b294776/Desktop/Workspace/Projects/misk/myfirstpypkg, inifile: setup.cfg, testpaths: tests/</a>
<a class="sourceLine" id="cb48-5" data-line-number="5"><span class="ex">collected</span> 1 item                                                                               </a>
<a class="sourceLine" id="cb48-6" data-line-number="6"></a>
<a class="sourceLine" id="cb48-7" data-line-number="7"><span class="ex">tests/test_mean.py</span> F                                                                     [100%]</a>
<a class="sourceLine" id="cb48-8" data-line-number="8"></a>
<a class="sourceLine" id="cb48-9" data-line-number="9">=========================================== <span class="ex">FAILURES</span> ===========================================</a>
<a class="sourceLine" id="cb48-10" data-line-number="10"><span class="ex">_________________________________________</span> test_my_mean _________________________________________</a>
<a class="sourceLine" id="cb48-11" data-line-number="11"></a>
<a class="sourceLine" id="cb48-12" data-line-number="12">    <span class="ex">def</span> test_my_mean()<span class="bu">:</span></a>
<a class="sourceLine" id="cb48-13" data-line-number="13">        <span class="ex">x</span> = range(0, 11)</a>
<a class="sourceLine" id="cb48-14" data-line-number="14"><span class="op">&gt;</span>       <span class="ex">assert</span> my_mean(x) == <span class="ex">5</span></a>
<a class="sourceLine" id="cb48-15" data-line-number="15"><span class="ex">E</span>       assert None == 5</a>
<a class="sourceLine" id="cb48-16" data-line-number="16"><span class="ex">E</span>        +  where None = my_mean(range(0, 11))</a>
<a class="sourceLine" id="cb48-17" data-line-number="17"></a>
<a class="sourceLine" id="cb48-18" data-line-number="18"><span class="ex">tests</span>/test_mean.py:<span class="ex">5</span>: AssertionError</a>
<a class="sourceLine" id="cb48-19" data-line-number="19">=================================== <span class="ex">short</span> test summary info ====================================</a>
<a class="sourceLine" id="cb48-20" data-line-number="20"><span class="ex">FAILED</span> tests/test_mean.py::test_my_mean - assert None == 5</a>
<a class="sourceLine" id="cb48-21" data-line-number="21">====================================== <span class="ex">1</span> failed in 0.09s =======================================</a></code></pre></div>
<p>As you see above, our test is failing. So let’s start adding code to make this test pass. We know that the mean is computed as <span class="math inline">\(m = \frac{\text{sum of terms}}{\text{number of terms}}\)</span>. Let’s update our function to account for that:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="kw">def</span> my_mean(x):</a>
<a class="sourceLine" id="cb49-2" data-line-number="2">    total <span class="op">=</span> <span class="bu">sum</span>(x)</a>
<a class="sourceLine" id="cb49-3" data-line-number="3">    units <span class="op">=</span> <span class="bu">len</span>(x)</a>
<a class="sourceLine" id="cb49-4" data-line-number="4">    <span class="cf">return</span> total <span class="op">/</span> units</a></code></pre></div>
<p>Now running our test again we get success!</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="ex">pytest</span></a>
<a class="sourceLine" id="cb50-2" data-line-number="2">========================================= <span class="bu">test</span> session starts =========================================</a>
<a class="sourceLine" id="cb50-3" data-line-number="3"><span class="ex">platform</span> darwin -- Python 3.7.3, pytest-5.4.2, py-1.8.1, pluggy-0.13.1</a>
<a class="sourceLine" id="cb50-4" data-line-number="4"><span class="ex">rootdir</span>: /Users/b294776/Desktop/Workspace/Projects/misk/myfirstpypkg, inifile: setup.cfg, testpaths: tests/</a>
<a class="sourceLine" id="cb50-5" data-line-number="5"><span class="ex">collected</span> 1 item                                                                                      </a>
<a class="sourceLine" id="cb50-6" data-line-number="6"></a>
<a class="sourceLine" id="cb50-7" data-line-number="7"><span class="ex">tests/test_mean.py</span> .                                                                            [100%]</a>
<a class="sourceLine" id="cb50-8" data-line-number="8"></a>
<a class="sourceLine" id="cb50-9" data-line-number="9">========================================== <span class="ex">1</span> passed in 0.01s ==========================================</a></code></pre></div>
<p>We likely want to iterate like this to make our function more robust. For example, what happens if a user passes non-numeric values or a non-list data structure to our function? Or what happens if our list contains <code>None</code>, <code>np.nan</code>, or or some other missing value representation values? For each scenario like this we want to create a test first, make sure it fails, and then add the new functionality to our code to make our tests pass. We’ll explore this process more in chapter <a href="test.html#test">7</a>.</p>
<p>We have empirical evidence that <code>my_mean()</code> works so now let’s talk about documentation.</p>
</div>
<div id="step-6-document-1" class="section level3">
<h3><span class="header-section-number">4.7.6</span> Step 6: Document</h3>
<p>We now have new working functionality in our package, the last thing we want to do is properly document our function. We do this with <a href="https://www.python.org/dev/peps/pep-0257/">docstrings</a>. We can add object-level documentation to our <code>my_mean()</code> function like this:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="kw">def</span> my_mean(x):</a>
<a class="sourceLine" id="cb51-2" data-line-number="2">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb51-3" data-line-number="3"><span class="co">    Mean of a vector</span></a>
<a class="sourceLine" id="cb51-4" data-line-number="4"></a>
<a class="sourceLine" id="cb51-5" data-line-number="5"><span class="co">    Computes arithmetic mean of a vector with numeric or logical values.</span></a>
<a class="sourceLine" id="cb51-6" data-line-number="6"></a>
<a class="sourceLine" id="cb51-7" data-line-number="7"><span class="co">    Parameters</span></a>
<a class="sourceLine" id="cb51-8" data-line-number="8"><span class="co">    ----------</span></a>
<a class="sourceLine" id="cb51-9" data-line-number="9"><span class="co">    x</span></a>
<a class="sourceLine" id="cb51-10" data-line-number="10"><span class="co">        A numeric or logical list.</span></a>
<a class="sourceLine" id="cb51-11" data-line-number="11"></a>
<a class="sourceLine" id="cb51-12" data-line-number="12"><span class="co">    Returns</span></a>
<a class="sourceLine" id="cb51-13" data-line-number="13"><span class="co">    -------</span></a>
<a class="sourceLine" id="cb51-14" data-line-number="14"><span class="co">    The arithmetic mean of the values in x returned as a numeric vector of length one.</span></a>
<a class="sourceLine" id="cb51-15" data-line-number="15"></a>
<a class="sourceLine" id="cb51-16" data-line-number="16"><span class="co">    Examples</span></a>
<a class="sourceLine" id="cb51-17" data-line-number="17"><span class="co">    --------</span></a>
<a class="sourceLine" id="cb51-18" data-line-number="18"><span class="co">    &gt;&gt;&gt; x = range(0, 11)</span></a>
<a class="sourceLine" id="cb51-19" data-line-number="19"><span class="co">    ... my_mean(x)</span></a>
<a class="sourceLine" id="cb51-20" data-line-number="20"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb51-21" data-line-number="21">    total <span class="op">=</span> <span class="bu">sum</span>(x)</a>
<a class="sourceLine" id="cb51-22" data-line-number="22">    units <span class="op">=</span> <span class="bu">len</span>(x)</a>
<a class="sourceLine" id="cb51-23" data-line-number="23">    <span class="cf">return</span> total <span class="op">/</span> units</a></code></pre></div>
<p>After adding the documentation we can now get various help documentation on the function. For example, hovering over the function in my editor shows the following:</p>
<p><img src="figures/help-docs-python.png" style="display: block; margin: auto;" /></p>
<p>After adding the documentation its best to re-run the tests to ensure nothing unexpected happened while adding the documentation. Later chapters will go into the details of docstrings along with other documentation we should be updating along the way (i.e. module level docstrings, CHANGELOG.md).</p>
</div>
<div id="step-7-version-control" class="section level3">
<h3><span class="header-section-number">4.7.7</span> Step 7: Version control</h3>
<p>We now have the new functionality and documentation in place. Now we need to commit our changes, push them to Github and do a pull request to merge into the development branch of the package.</p>
<div class="tip">
<p>
Learn about writing clear and effective git messages <a href="http://udacity.github.io/git-styleguide/">here</a>.
</p>
</div>
<div class="sourceCode" id="cb52"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="fu">git</span> add -A</a>
<a class="sourceLine" id="cb52-2" data-line-number="2"><span class="fu">git</span> commit -m <span class="st">&quot;feat: add my_mean to compute arithmetic mean&quot;</span></a>
<a class="sourceLine" id="cb52-3" data-line-number="3"><span class="fu">git</span> push --set-upstream origin add_mean</a></code></pre></div>
<p>Once the changes have been pushed to Github you will notice the updated branch changes were successfully pushed. Next, select the “Compare &amp; pull request” button next to the new changes:</p>
<p><img src="figures/new-branch-then-pr-python.png" style="display: block; margin: auto;" /></p>
<p>Be sure to choose the “base: develop” option for the pull request. This will signal that we want to merge our changes in the the feature branch with the develop branch:</p>
<p><img src="figures/pr-into-develop.png" style="display: block; margin: auto;" /></p>
<p>Next we add a good summary of the pull request that signals what we added/changed and that we ran tests and checks successfully. After you add the message, go ahead and tag a friend or colleague to review your pull request. With more formalized projects we typically require that 1-2 folks have reviewed code changes in pull requests.</p>
<p><img src="figures/pr-msg-python.png" style="display: block; margin: auto;" /></p>
<p>Once all reviewers have successfully signed off on the pull request go ahead and merge it into develop.</p>
<div class="tip">
<p>
If pull requests are new to you, read more about them here:
</p>
<ul>
<li>
<a href="https://help.github.com/en/github/collaborating-with-issues-and-pull-requests">Github help docs</a>
</li>
<li>
<a href="https://www.atlassian.com/blog/git/written-unwritten-guide-pull-requests">The (written) unwritten guide to pull requests</a>
</li>
<li>
<a href="https://github.community/t/best-practices-for-pull-requests/10195">Best practices for pull requests</a>
</li>
</ul>
</div>

</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="structure.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="metadata.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/bradleyboehmke/misk-packages/edit/master/03-workflow.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
