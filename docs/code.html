<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Source Code | Delivering Data Science Products via Packages</title>
  <meta name="description" content="Creating R and Python packages to scale data science." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Source Code | Delivering Data Science Products via Packages" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Creating R and Python packages to scale data science." />
  <meta name="github-repo" content="bradleyboehmke/misk-packages" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Source Code | Delivering Data Science Products via Packages" />
  
  <meta name="twitter:description" content="Creating R and Python packages to scale data science." />
  



<meta name="date" content="2020-06-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="metadata.html"/>
<link rel="next" href="test.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Creating Packages</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#who-should-read-this"><i class="fa fa-check"></i>Who should read this</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-you-need-for-this-book"><i class="fa fa-check"></i>What you need for this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#conventions-used-in-this-book"><i class="fa fa-check"></i>Conventions used in this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#feedback"><i class="fa fa-check"></i>Feedback</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
</ul></li>
<li class="part"><span><b>I Getting Started</b></span></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction to Packaging</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#why-is-packaging-important"><i class="fa fa-check"></i><b>2.1</b> Why is packaging important</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#when-packaging-might-not-be-needed"><i class="fa fa-check"></i><b>2.2</b> When packaging might not be needed</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#an-opinionated-approach"><i class="fa fa-check"></i><b>2.3</b> An opinionated approach</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="structure.html"><a href="structure.html"><i class="fa fa-check"></i><b>3</b> Package Structure</a><ul>
<li class="chapter" data-level="3.1" data-path="structure.html"><a href="structure.html#example"><i class="fa fa-check"></i><b>3.1</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> example</a></li>
<li class="chapter" data-level="3.2" data-path="structure.html"><a href="structure.html#example-1"><i class="fa fa-check"></i><b>3.2</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> example</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="workflow.html"><a href="workflow.html"><i class="fa fa-check"></i><b>4</b> Development Workflow</a><ul>
<li class="chapter" data-level="4.1" data-path="workflow.html"><a href="workflow.html#create-the-package"><i class="fa fa-check"></i><b>4.1</b> Create the package</a><ul>
<li class="chapter" data-level="4.1.1" data-path="workflow.html"><a href="workflow.html#naming"><i class="fa fa-check"></i><b>4.1.1</b> Naming</a></li>
<li class="chapter" data-level="4.1.2" data-path="workflow.html"><a href="workflow.html#create"><i class="fa fa-check"></i><b>4.1.2</b> Create</a></li>
<li class="chapter" data-level="4.1.3" data-path="workflow.html"><a href="workflow.html#version-control"><i class="fa fa-check"></i><b>4.1.3</b> Version control</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="workflow.html"><a href="workflow.html#setup-a-virtual-environment"><i class="fa fa-check"></i><b>4.2</b> Setup a virtual environment</a></li>
<li class="chapter" data-level="4.3" data-path="workflow.html"><a href="workflow.html#add-new-functionality"><i class="fa fa-check"></i><b>4.3</b> Add new functionality</a></li>
<li class="chapter" data-level="4.4" data-path="workflow.html"><a href="workflow.html#document"><i class="fa fa-check"></i><b>4.4</b> Document</a></li>
<li class="chapter" data-level="4.5" data-path="workflow.html"><a href="workflow.html#version-control-1"><i class="fa fa-check"></i><b>4.5</b> Version control</a></li>
<li class="chapter" data-level="4.6" data-path="workflow.html"><a href="workflow.html#example-2"><i class="fa fa-check"></i><b>4.6</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> example</a><ul>
<li class="chapter" data-level="4.6.1" data-path="workflow.html"><a href="workflow.html#step-1-check-package-name"><i class="fa fa-check"></i><b>4.6.1</b> Step 1: Check package name</a></li>
<li class="chapter" data-level="4.6.2" data-path="workflow.html"><a href="workflow.html#step-2-create-package-directory-and-structure"><i class="fa fa-check"></i><b>4.6.2</b> Step 2: Create package directory and structure</a></li>
<li class="chapter" data-level="4.6.3" data-path="workflow.html"><a href="workflow.html#step-3-version-control"><i class="fa fa-check"></i><b>4.6.3</b> Step 3: Version control</a></li>
<li class="chapter" data-level="4.6.4" data-path="workflow.html"><a href="workflow.html#step-4-setup-virtual-environment"><i class="fa fa-check"></i><b>4.6.4</b> Step 4: Setup virtual environment</a></li>
<li class="chapter" data-level="4.6.5" data-path="workflow.html"><a href="workflow.html#step-5-add-new-functionality"><i class="fa fa-check"></i><b>4.6.5</b> Step 5: Add new functionality</a></li>
<li class="chapter" data-level="4.6.6" data-path="workflow.html"><a href="workflow.html#step-6-document"><i class="fa fa-check"></i><b>4.6.6</b> Step 6: Document</a></li>
<li class="chapter" data-level="4.6.7" data-path="workflow.html"><a href="workflow.html#step-8-version-control"><i class="fa fa-check"></i><b>4.6.7</b> Step 8: Version control</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="workflow.html"><a href="workflow.html#example-3"><i class="fa fa-check"></i><b>4.7</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> example</a><ul>
<li class="chapter" data-level="4.7.1" data-path="workflow.html"><a href="workflow.html#step-1-check-package-name-1"><i class="fa fa-check"></i><b>4.7.1</b> Step 1: Check package name</a></li>
<li class="chapter" data-level="4.7.2" data-path="workflow.html"><a href="workflow.html#step-2-create-package-directory-and-structure-1"><i class="fa fa-check"></i><b>4.7.2</b> Step 2: Create package directory and structure</a></li>
<li class="chapter" data-level="4.7.3" data-path="workflow.html"><a href="workflow.html#step-3-version-control-1"><i class="fa fa-check"></i><b>4.7.3</b> Step 3: Version control</a></li>
<li class="chapter" data-level="4.7.4" data-path="workflow.html"><a href="workflow.html#step-4-setup-virtual-environment-1"><i class="fa fa-check"></i><b>4.7.4</b> Step 4: Setup virtual environment</a></li>
<li class="chapter" data-level="4.7.5" data-path="workflow.html"><a href="workflow.html#step-5-add-new-functionality-1"><i class="fa fa-check"></i><b>4.7.5</b> Step 5: Add new functionality</a></li>
<li class="chapter" data-level="4.7.6" data-path="workflow.html"><a href="workflow.html#step-6-document-1"><i class="fa fa-check"></i><b>4.7.6</b> Step 6: Document</a></li>
<li class="chapter" data-level="4.7.7" data-path="workflow.html"><a href="workflow.html#step-7-version-control"><i class="fa fa-check"></i><b>4.7.7</b> Step 7: Version control</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Package Components</b></span></li>
<li class="chapter" data-level="5" data-path="metadata.html"><a href="metadata.html"><i class="fa fa-check"></i><b>5</b> Package Metadata</a><ul>
<li class="chapter" data-level="5.1" data-path="metadata.html"><a href="metadata.html#name-and-package-description"><i class="fa fa-check"></i><b>5.1</b> Name and package description</a></li>
<li class="chapter" data-level="5.2" data-path="metadata.html"><a href="metadata.html#author-and-contact-info"><i class="fa fa-check"></i><b>5.2</b> Author and contact info</a></li>
<li class="chapter" data-level="5.3" data-path="metadata.html"><a href="metadata.html#dependencies"><i class="fa fa-check"></i><b>5.3</b> Dependencies</a></li>
<li class="chapter" data-level="5.4" data-path="metadata.html"><a href="metadata.html#versioning"><i class="fa fa-check"></i><b>5.4</b> Versioning</a></li>
<li class="chapter" data-level="5.5" data-path="metadata.html"><a href="metadata.html#license"><i class="fa fa-check"></i><b>5.5</b> License</a></li>
<li class="chapter" data-level="5.6" data-path="metadata.html"><a href="metadata.html#project-source"><i class="fa fa-check"></i><b>5.6</b> Project source</a></li>
<li class="chapter" data-level="5.7" data-path="metadata.html"><a href="metadata.html#other"><i class="fa fa-check"></i><b>5.7</b> Other</a></li>
<li class="chapter" data-level="5.8" data-path="metadata.html"><a href="metadata.html#example-4"><i class="fa fa-check"></i><b>5.8</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> example</a><ul>
<li class="chapter" data-level="5.8.1" data-path="metadata.html"><a href="metadata.html#dependencies-1"><i class="fa fa-check"></i><b>5.8.1</b> Dependencies</a></li>
<li class="chapter" data-level="5.8.2" data-path="metadata.html"><a href="metadata.html#exercises"><i class="fa fa-check"></i><b>5.8.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="metadata.html"><a href="metadata.html#example-5"><i class="fa fa-check"></i><b>5.9</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> example</a><ul>
<li class="chapter" data-level="5.9.1" data-path="metadata.html"><a href="metadata.html#dependencies-2"><i class="fa fa-check"></i><b>5.9.1</b> Dependencies</a></li>
<li class="chapter" data-level="5.9.2" data-path="metadata.html"><a href="metadata.html#exercises-1"><i class="fa fa-check"></i><b>5.9.2</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="code.html"><a href="code.html"><i class="fa fa-check"></i><b>6</b> Source Code</a><ul>
<li class="chapter" data-level="6.1" data-path="code.html"><a href="code.html#organization"><i class="fa fa-check"></i><b>6.1</b> Organization</a><ul>
<li class="chapter" data-level="6.1.1" data-path="code.html"><a href="code.html#individual-units"><i class="fa fa-check"></i><b>6.1.1</b> Individual units</a></li>
<li class="chapter" data-level="6.1.2" data-path="code.html"><a href="code.html#expanding-code-breadth"><i class="fa fa-check"></i><b>6.1.2</b> Expanding code breadth</a></li>
<li class="chapter" data-level="6.1.3" data-path="code.html"><a href="code.html#aggregating-functionality"><i class="fa fa-check"></i><b>6.1.3</b> Aggregating functionality</a></li>
<li class="chapter" data-level="6.1.4" data-path="code.html"><a href="code.html#naming-is-important"><i class="fa fa-check"></i><b>6.1.4</b> Naming is important</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="code.html"><a href="code.html#external-vs-internal"><i class="fa fa-check"></i><b>6.2</b> External vs internal</a></li>
<li class="chapter" data-level="6.3" data-path="code.html"><a href="code.html#example-6"><i class="fa fa-check"></i><b>6.3</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> example</a><ul>
<li class="chapter" data-level="6.3.1" data-path="code.html"><a href="code.html#setup"><i class="fa fa-check"></i><b>6.3.1</b> Setup</a></li>
<li class="chapter" data-level="6.3.2" data-path="code.html"><a href="code.html#internal-function"><i class="fa fa-check"></i><b>6.3.2</b> Internal function</a></li>
<li class="chapter" data-level="6.3.3" data-path="code.html"><a href="code.html#adding-breadth"><i class="fa fa-check"></i><b>6.3.3</b> Adding breadth</a></li>
<li class="chapter" data-level="6.3.4" data-path="code.html"><a href="code.html#adding-aggregation"><i class="fa fa-check"></i><b>6.3.4</b> Adding aggregation</a></li>
<li class="chapter" data-level="6.3.5" data-path="code.html"><a href="code.html#final-checks-version-control"><i class="fa fa-check"></i><b>6.3.5</b> Final checks &amp; version control</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="code.html"><a href="code.html#example-7"><i class="fa fa-check"></i><b>6.4</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> example</a><ul>
<li class="chapter" data-level="6.4.1" data-path="code.html"><a href="code.html#setup-1"><i class="fa fa-check"></i><b>6.4.1</b> Setup</a></li>
<li class="chapter" data-level="6.4.2" data-path="code.html"><a href="code.html#internal-function-1"><i class="fa fa-check"></i><b>6.4.2</b> Internal function</a></li>
<li class="chapter" data-level="6.4.3" data-path="code.html"><a href="code.html#adding-breadth-1"><i class="fa fa-check"></i><b>6.4.3</b> Adding breadth</a></li>
<li class="chapter" data-level="6.4.4" data-path="code.html"><a href="code.html#adding-aggregation-1"><i class="fa fa-check"></i><b>6.4.4</b> Adding aggregation</a></li>
<li class="chapter" data-level="6.4.5" data-path="code.html"><a href="code.html#simplify-user-access"><i class="fa fa-check"></i><b>6.4.5</b> Simplify user access</a></li>
<li class="chapter" data-level="6.4.6" data-path="code.html"><a href="code.html#final-checks-version-control-1"><i class="fa fa-check"></i><b>6.4.6</b> Final checks &amp; version control</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="test.html"><a href="test.html"><i class="fa fa-check"></i><b>7</b> Testing</a><ul>
<li class="chapter" data-level="7.1" data-path="test.html"><a href="test.html#why-test"><i class="fa fa-check"></i><b>7.1</b> Why test</a></li>
<li class="chapter" data-level="7.2" data-path="test.html"><a href="test.html#what-to-test"><i class="fa fa-check"></i><b>7.2</b> What to test</a></li>
<li class="chapter" data-level="7.3" data-path="test.html"><a href="test.html#test-organization"><i class="fa fa-check"></i><b>7.3</b> Test organization</a></li>
<li class="chapter" data-level="7.4" data-path="test.html"><a href="test.html#types-of-tests"><i class="fa fa-check"></i><b>7.4</b> Types of tests</a></li>
<li class="chapter" data-level="7.5" data-path="test.html"><a href="test.html#writing-tests"><i class="fa fa-check"></i><b>7.5</b> Writing tests</a></li>
<li class="chapter" data-level="7.6" data-path="test.html"><a href="test.html#additional-resources"><i class="fa fa-check"></i><b>7.6</b> Additional resources</a></li>
<li class="chapter" data-level="7.7" data-path="test.html"><a href="test.html#example-8"><i class="fa fa-check"></i><b>7.7</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> example</a><ul>
<li class="chapter" data-level="7.7.1" data-path="test.html"><a href="test.html#test-organization-1"><i class="fa fa-check"></i><b>7.7.1</b> Test organization</a></li>
<li class="chapter" data-level="7.7.2" data-path="test.html"><a href="test.html#writing-a-test"><i class="fa fa-check"></i><b>7.7.2</b> Writing a test</a></li>
<li class="chapter" data-level="7.7.3" data-path="test.html"><a href="test.html#what-to-test-1"><i class="fa fa-check"></i><b>7.7.3</b> What to test</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="test.html"><a href="test.html#example-9"><i class="fa fa-check"></i><b>7.8</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> example</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="object-docs.html"><a href="object-docs.html"><i class="fa fa-check"></i><b>8</b> Object Documentation</a><ul>
<li class="chapter" data-level="8.1" data-path="object-docs.html"><a href="object-docs.html#section"><i class="fa fa-check"></i><b>8.1</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg></a></li>
<li class="chapter" data-level="8.2" data-path="object-docs.html"><a href="object-docs.html#section-1"><i class="fa fa-check"></i><b>8.2</b> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="changelog.html"><a href="changelog.html"><i class="fa fa-check"></i><b>9</b> Changelog</a></li>
<li class="chapter" data-level="10" data-path="readme.html"><a href="readme.html"><i class="fa fa-check"></i><b>10</b> README</a></li>
<li class="chapter" data-level="11" data-path="website.html"><a href="website.html"><i class="fa fa-check"></i><b>11</b> Package Website</a></li>
<li class="chapter" data-level="12" data-path="metadata.html"><a href="metadata.html#other"><i class="fa fa-check"></i><b>12</b> Other Components</a></li>
<li class="part"><span><b>III Continuous Integration &amp; Deployment</b></span></li>
<li class="chapter" data-level="13" data-path="tbd.html"><a href="tbd.html"><i class="fa fa-check"></i><b>13</b> TBD</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Delivering Data Science Products via Packages</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="code" class="section level1">
<h1><span class="header-section-number">6</span> Source Code</h1>
<p>An important principle in any project is how to manage the source code. In this chapter, you‚Äôll learn about the directories that hold the <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> and <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> package source code and some general tips for organizing source code functionality. We‚Äôll also add some new functionality to our package to demonstrate our thoughts.</p>
<div id="organization" class="section level2">
<h2><span class="header-section-number">6.1</span> Organization</h2>
<p>Organizing your source code provides many benefits such as:</p>
<ul>
<li>making the intentions of the code obvious,</li>
<li>making it easy for others to contribute,</li>
<li>making it easy for you to maintain,</li>
<li>making it easy to debug,</li>
<li>making it easy to expand.</li>
</ul>
<div class="note">
<p>
There are very few strict requirements in how you organize your code but what follows are general best practices.
</p>
</div>
<div id="individual-units" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Individual units</h3>
<blockquote>
<p><em>‚ÄúFunctions should do one thing. They should do it well. They should do it only.‚Äù</em> - Robert Martin</p>
</blockquote>
<p>Individual units of functionality (i.e.¬†functions, methods, classes) should be <font size="-2">small.</font> How small? That‚Äôs the magic question ü§∑. Individual units of functionality should not require significant scrolling in your editor. They should be very clear regarding the intention and functionality they are providing. And they should only <em>‚Äúdo one thing‚Äù</em>.</p>
<div class="tip">
<p>
One way to know if a function is doing more than one thing is if you can extract another function from it with a name that is not merely a restatement of its implementation.
</p>
</div>
<p>So far our package has only one simple function; however, we typically build our packages to be more comprehensive and complex. Organizing this expansion is important. There are two main ways our code expands:</p>
<ol style="list-style-type: decimal">
<li>breadth: we add more functionality but not necessarily building onto existing functionality,</li>
<li>aggregation: we continue building onto existing functionality to create layers of abstraction.</li>
</ol>
</div>
<div id="expanding-code-breadth" class="section level3">
<h3><span class="header-section-number">6.1.2</span> Expanding code breadth</h3>
<p>Expanding code breadth is easier to maintain. For our example package that currently has a <code>my_mean()</code> function, this could include adding new functions such as <code>my_median()</code> and <code>my_mode()</code>. When expanding code breadth the main thing you should consider is where to put the new functionality.</p>
<p>Grouping like functionality into one file is good. For example, since <code>my_mean()</code>, <code>my_median()</code> and <code>my_mode()</code> are all forms of central tendencies we may put them in the same file while functions with other purposes (i.e.¬†deviations) may go into a different file.</p>
<p>While you‚Äôre free to arrange functions into files as you wish, the two extremes are bad: don‚Äôt put all functions into one file and don‚Äôt put each function into its own separate file. (It‚Äôs OK if some files only contain one function, particularly if the function is large üõë or has a lot of documentation.).</p>
</div>
<div id="aggregating-functionality" class="section level3">
<h3><span class="header-section-number">6.1.3</span> Aggregating functionality</h3>
<p>Often, we write code that builds on top of each other. This is known as creating higher levels of abstraction. For example, say we wanted to create a function that computes the z-score, which uses the mean and standard deviations (<span class="math inline">\(z=\frac{x - \mu}{\sigma}\)</span>). This is a higher level of abstraction and we should write our code in such a way that:</p>
<ol style="list-style-type: decimal">
<li>our code reads like a top-down narrative,</li>
<li>functionality is abstracted away and grouped at similar levels of abstraction.</li>
</ol>
<p>If your code still fits into one file, we want the code to read like a top-down narrative where the highest level of abstraction is exposed first followed by the next level of abstraction. This means your highest abstracted function should be at the top of the .R or .py script and then as you scroll down functions lower level functions that provide supporting help should be listed. For example, a simple file that holds functionality to compute the z-score would look like:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb59-1" data-line-number="1"><span class="co"># highest abstracted level</span></a>
<a class="sourceLine" id="cb59-2" data-line-number="2"><span class="kw">def</span> z_score():</a>
<a class="sourceLine" id="cb59-3" data-line-number="3">  <span class="cf">pass</span></a>
<a class="sourceLine" id="cb59-4" data-line-number="4">  </a>
<a class="sourceLine" id="cb59-5" data-line-number="5"><span class="co"># next layer of abstractoin</span></a>
<a class="sourceLine" id="cb59-6" data-line-number="6"><span class="kw">def</span> my_mean():</a>
<a class="sourceLine" id="cb59-7" data-line-number="7">  <span class="cf">pass</span></a>
<a class="sourceLine" id="cb59-8" data-line-number="8">  </a>
<a class="sourceLine" id="cb59-9" data-line-number="9"><span class="kw">def</span> my_sd():</a>
<a class="sourceLine" id="cb59-10" data-line-number="10">  <span class="cf">pass</span></a>
<a class="sourceLine" id="cb59-11" data-line-number="11">  </a>
<a class="sourceLine" id="cb59-12" data-line-number="12"><span class="co"># lowest level of abstraction</span></a>
<a class="sourceLine" id="cb59-13" data-line-number="13"><span class="kw">def</span> validate_input():</a>
<a class="sourceLine" id="cb59-14" data-line-number="14">  <span class="cf">pass</span></a></code></pre></div>
<p>If your code grows signicantly then you want to separate functionality into separate files but still group functions based on similar levels of abstraction.</p>
</div>
<div id="naming-is-important" class="section level3">
<h3><span class="header-section-number">6.1.4</span> Naming is important</h3>
<p>Naming is important but as our source code grows it becomes even moreso. Here are some good naming tips:</p>
<ul>
<li>If a file contains a single function, give the file the same name as the function.</li>
<li>If a file contains multiple related functions, give it a concise, but descriptive name. For example, we could group <code>my_mean()</code>, <code>my_median()</code> and <code>my_mode()</code> together into a file named <code>central_tendencies</code>.</li>
<li>Sometimes you have many helper functions in your source code that all support one primary user facing API functionality. Put the user-facing API function/class into a file named <code>main</code> or <code>main_api</code>.</li>
<li>Many times people create a general <code>utils</code> file to hold general utility functions. This is not advised. Always try to find a proper home and name for all supporting functions. This is a <a href="https://breadcrumbscollector.tech/stop-naming-your-python-modules-utils/">great read</a> explaining why.</li>
<li>Deprecated functions should live in a file or directory that makes it obvious they are deprecated (i.e.¬†prefix file name with <code>deprec-</code>).</li>
</ul>
</div>
</div>
<div id="external-vs-internal" class="section level2">
<h2><span class="header-section-number">6.2</span> External vs internal</h2>
<p>When developing packages, we often build functions with two main purposes:</p>
<ol style="list-style-type: decimal">
<li>External use: functions that are designed to be used by the end-user. This is the primary purpose of writing a package, to make some functionality easier for an end-user.</li>
<li>Internal use: functions that are designed to help you, the developer, write efficient and effect code. Internal functions are usually not intended for external use by end-users.</li>
</ol>
<p>With both <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> and <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> you have the ability to make your functions be either externally or internally focused. In the sections that follow we will illustrate how but it is important that you apply the same rules to both external and internal functions - document and test <strong>all</strong> your functions. Although not a requirement this will make your life and other developer‚Äôs lives that want to contribute much easier.</p>
</div>
<div id="example-6" class="section level2">
<h2><span class="header-section-number">6.3</span> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> example</h2>
<p>For an <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> package, all source code goes in the <code>R/</code> directory and you cannot have subdirectories<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>.</p>
<p>Let‚Äôs add some functionality to our package to illustrate some points from our previous discussion:</p>
<ul>
<li>add an internally-focused function that validates the user inputs,</li>
<li>add breadth to our package by adding additional summary statistics computations,</li>
<li>add aggregation to our package by adding a z-score computation that leverages other functions within our package.</li>
</ul>
<div class="note">
<p>
To simplify, we‚Äôll show the final functions and tests added rather than illustrate every step of the test-driven development process.
</p>
</div>
<div id="setup" class="section level3">
<h3><span class="header-section-number">6.3.1</span> Setup</h3>
<p>Before we start adding new functionality, let‚Äôs make sure the current code base is ready. Open up your R project, switch to the develop branch and make sure it is current with your remote repo:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb60-1" data-line-number="1"><span class="fu">git</span> checkout develop</a>
<a class="sourceLine" id="cb60-2" data-line-number="2"><span class="fu">git</span> pull</a></code></pre></div>
<p>Now let‚Äôs create a new branch to add this chapter‚Äôs new functionality. Usually you name the branch after the new functionality that you‚Äôre adding or a Github issue that you are addressing. In our case we can name the branch ‚Äúch6‚Äù since it‚Äôs related to this chapter.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb61-1" data-line-number="1"><span class="fu">git</span> checkout -b ch6</a></code></pre></div>
</div>
<div id="internal-function" class="section level3">
<h3><span class="header-section-number">6.3.2</span> Internal function</h3>
<p>First, we‚Äôll add an internally-focused function that validates the user inputs. Since we may continue to expand our package and add more validation procedures, we typically create a validation.R file to hold these functions.</p>
<p>Go ahead and create the test and .R file:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1">usethis<span class="op">::</span><span class="kw">use_test</span>(<span class="st">&quot;validation&quot;</span>)</a>
<a class="sourceLine" id="cb62-2" data-line-number="2">usethis<span class="op">::</span><span class="kw">use_r</span>(<span class="st">&quot;validation&quot;</span>)</a></code></pre></div>
<p>Place the following in the <code>test-validation.R</code> test file:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1"><span class="kw">test_that</span>(<span class="st">&quot;inputs are a numeric vector&quot;</span>, {</a>
<a class="sourceLine" id="cb63-2" data-line-number="2">  <span class="kw">expect_error</span>(<span class="kw">validate_numeric_vector</span>(<span class="st">&quot;a&quot;</span>))</a>
<a class="sourceLine" id="cb63-3" data-line-number="3">  <span class="kw">expect_error</span>(<span class="kw">validate_numeric_vector</span>(<span class="kw">factor</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)))</a>
<a class="sourceLine" id="cb63-4" data-line-number="4">  <span class="kw">expect_error</span>(<span class="kw">validate_numeric_vector</span>(<span class="kw">list</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)))</a>
<a class="sourceLine" id="cb63-5" data-line-number="5"></a>
<a class="sourceLine" id="cb63-6" data-line-number="6">  <span class="kw">expect_silent</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb63-7" data-line-number="7">  <span class="kw">expect_silent</span>(<span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb63-8" data-line-number="8">})</a></code></pre></div>
<p>and the following in the <code>validation.R</code> source code file:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1"><span class="co">#&#39; Validate numeric vector input</span></a>
<a class="sourceLine" id="cb64-2" data-line-number="2"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb64-3" data-line-number="3"><span class="co">#&#39; @description</span></a>
<a class="sourceLine" id="cb64-4" data-line-number="4"><span class="co">#&#39; Checks that an in put is a vector that contains numeric inputs or</span></a>
<a class="sourceLine" id="cb64-5" data-line-number="5"><span class="co">#&#39; logical values that can be coerced to numeric values..</span></a>
<a class="sourceLine" id="cb64-6" data-line-number="6"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb64-7" data-line-number="7"><span class="co">#&#39; @param x A numeric or logical vector.</span></a>
<a class="sourceLine" id="cb64-8" data-line-number="8"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb64-9" data-line-number="9"><span class="co">#&#39; @return</span></a>
<a class="sourceLine" id="cb64-10" data-line-number="10"><span class="co">#&#39; Raises exception if input is not a numeric or logical vector; otherwise</span></a>
<a class="sourceLine" id="cb64-11" data-line-number="11"><span class="co">#&#39; provides a silent return.</span></a>
<a class="sourceLine" id="cb64-12" data-line-number="12"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb64-13" data-line-number="13"><span class="co">#&#39; @examples</span></a>
<a class="sourceLine" id="cb64-14" data-line-number="14"><span class="co">#&#39; x &lt;- 1:10</span></a>
<a class="sourceLine" id="cb64-15" data-line-number="15"><span class="co">#&#39; myfirstpkg:::validate_numeric_vector(x)</span></a>
<a class="sourceLine" id="cb64-16" data-line-number="16"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb64-17" data-line-number="17"><span class="co">#&#39; @keywords internal</span></a>
<a class="sourceLine" id="cb64-18" data-line-number="18">validate_numeric_vector &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb64-19" data-line-number="19">  <span class="kw">stopifnot</span>(<span class="kw">is.atomic</span>(x) <span class="op">||</span><span class="st"> </span><span class="kw">is.logical</span>(x), <span class="kw">is.numeric</span>(x))</a>
<a class="sourceLine" id="cb64-20" data-line-number="20">}</a></code></pre></div>
<p>Three important items to note in the above:</p>
<ol style="list-style-type: decimal">
<li>We used the <code>@keywords internal</code> tag instead of <code>@export</code> as we did in chapter <a href="workflow.html#workflow">4</a>. Only functions that are documented with <code>@export</code> are made explicitly visible to the end user. Using <code>@keywords internal</code> instead of <code>@export</code> signals that this function is for internal use only. Internal functions are still accessible to end users but they must use the triple <code>:::</code> syntax - <code>myfirstpkg:::validate_numeric_vector()</code>.</li>
<li>When including examples for internal functions you need to use the triple <code>:::</code> syntax - <code>myfirstpkg:::validate_numeric_vector()</code> otherwise you will get an error when you run <code>devtools::check()</code>.</li>
<li>Even though this is an internal function, we still document it as normal. This isn‚Äôt required but it helps us and contributing developers understand the purpose of the function.</li>
</ol>
<div class="tip">
<p>
Remember, as we add new code we always want to be running the tests.
</p>
<ol style="list-style-type: decimal">
<li>
load new functionality: <code>devtools::load_all()</code> or Cmd/Ctrl + Shift + L
</li>
<li>
test new functionality: <code>devtools::test()</code> or Cmd/Ctrl + Shift + T
</li>
<li>
document new functionality: <code>devtools::document()</code> or Cmd/Ctrl + Shift + D
</li>
</ol>
</div>
<p>Now before adding any new functionality, let‚Äôs add this validation function to our existing <code>my_mean()</code> function. Your <code>my_mean()</code> should look like:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1">my_mean &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb65-2" data-line-number="2">  <span class="kw">validate_numeric_vector</span>(x)</a>
<a class="sourceLine" id="cb65-3" data-line-number="3">  total &lt;-<span class="st"> </span><span class="kw">sum</span>(x)</a>
<a class="sourceLine" id="cb65-4" data-line-number="4">  units &lt;-<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb65-5" data-line-number="5">  <span class="kw">return</span>(total <span class="op">/</span><span class="st"> </span>units)</a>
<a class="sourceLine" id="cb65-6" data-line-number="6">}</a></code></pre></div>
</div>
<div id="adding-breadth" class="section level3">
<h3><span class="header-section-number">6.3.3</span> Adding breadth</h3>
<p>Next, let‚Äôs add a new summary statistic to our collection. For now, we‚Äôll store this summary statistic in the same file but in the future if this file became too large we may look to refactor and split up the centralized organization. Let‚Äôs rename the original <code>mean.R</code> file to <code>summary-stats.R</code> and also rename the associated test file to <code>test-summary-stats.R</code>.</p>
<div class="note">
<p>
It is common to rename files and functions as you begin developing a package since you are feeling out what the best design and organization will be but as your package matures this will happen less frequently.
</p>
</div>
<p>Now we‚Äôll add a function that computes the standard deviation. Add the following to the <code>test-summary-stats.R</code> file:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1"><span class="kw">test_that</span>(<span class="st">&quot;standard deviation of simple vector computes accurately&quot;</span>, {</a>
<a class="sourceLine" id="cb66-2" data-line-number="2">  x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb66-3" data-line-number="3">  <span class="kw">expect_equal</span>(<span class="kw">my_sd</span>(x), <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb66-4" data-line-number="4">})</a></code></pre></div>
<p>and add the following to the <code>summary-stats.R</code> file in the <code>R/</code> directory:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1"><span class="co">#&#39; Standard deviation of a vector</span></a>
<a class="sourceLine" id="cb67-2" data-line-number="2"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb67-3" data-line-number="3"><span class="co">#&#39; @description</span></a>
<a class="sourceLine" id="cb67-4" data-line-number="4"><span class="co">#&#39; Computes standard deviation of a vector with numeric or logical values.</span></a>
<a class="sourceLine" id="cb67-5" data-line-number="5"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb67-6" data-line-number="6"><span class="co">#&#39; @param x A numeric or logical vector.</span></a>
<a class="sourceLine" id="cb67-7" data-line-number="7"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb67-8" data-line-number="8"><span class="co">#&#39; @details</span></a>
<a class="sourceLine" id="cb67-9" data-line-number="9"><span class="co">#&#39; The denominator n - 1 is used which gives an unbiased estimator of the</span></a>
<a class="sourceLine" id="cb67-10" data-line-number="10"><span class="co">#&#39; (co)variance for i.i.d. observations.</span></a>
<a class="sourceLine" id="cb67-11" data-line-number="11"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb67-12" data-line-number="12"><span class="co">#&#39; @return</span></a>
<a class="sourceLine" id="cb67-13" data-line-number="13"><span class="co">#&#39; The standard deviation of the values in x returned as a numeric vector of</span></a>
<a class="sourceLine" id="cb67-14" data-line-number="14"><span class="co">#&#39; length one.</span></a>
<a class="sourceLine" id="cb67-15" data-line-number="15"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb67-16" data-line-number="16"><span class="co">#&#39; @examples</span></a>
<a class="sourceLine" id="cb67-17" data-line-number="17"><span class="co">#&#39; x &lt;- 1:10</span></a>
<a class="sourceLine" id="cb67-18" data-line-number="18"><span class="co">#&#39; my_sd(x)</span></a>
<a class="sourceLine" id="cb67-19" data-line-number="19"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb67-20" data-line-number="20"><span class="co">#&#39; @export</span></a>
<a class="sourceLine" id="cb67-21" data-line-number="21">my_sd &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb67-22" data-line-number="22">  <span class="kw">validate_numeric_vector</span>(x)</a>
<a class="sourceLine" id="cb67-23" data-line-number="23">  squared_diff &lt;-<span class="st"> </span>(x <span class="op">-</span><span class="st"> </span><span class="kw">my_mean</span>(x))<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb67-24" data-line-number="24">  total &lt;-<span class="st"> </span><span class="kw">sum</span>(squared_diff)</a>
<a class="sourceLine" id="cb67-25" data-line-number="25">  units &lt;-<span class="st"> </span><span class="kw">length</span>(x) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb67-26" data-line-number="26">  <span class="kw">return</span>(<span class="kw">sqrt</span>(total <span class="op">/</span><span class="st"> </span>units))</a>
<a class="sourceLine" id="cb67-27" data-line-number="27">}</a></code></pre></div>
</div>
<div id="adding-aggregation" class="section level3">
<h3><span class="header-section-number">6.3.4</span> Adding aggregation</h3>
<p>Last, we‚Äôll add a new summary statistics, the z-score, that leverages the <code>my_mean</code> and <code>my_sd</code> functions. Since this is adding onto our level of abstraction we‚Äôll place this at the top of our <code>R/summary_stats.R</code> file.</p>
<p>Add the following to the <code>test-summary-stats.R</code> file:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1"><span class="kw">test_that</span>(<span class="st">&quot;z-score of simple vector computes accurately&quot;</span>, {</a>
<a class="sourceLine" id="cb68-2" data-line-number="2">  x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb68-3" data-line-number="3">  expected &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb68-4" data-line-number="4">  <span class="kw">expect_equal</span>(<span class="kw">z_score</span>(x), expected)</a>
<a class="sourceLine" id="cb68-5" data-line-number="5">})</a></code></pre></div>
<p>and add the following to the <code>summary-stats.R</code> file in the <code>R/</code> directory:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1"><span class="co">#&#39; Z-score of a vector</span></a>
<a class="sourceLine" id="cb69-2" data-line-number="2"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb69-3" data-line-number="3"><span class="co">#&#39; @description</span></a>
<a class="sourceLine" id="cb69-4" data-line-number="4"><span class="co">#&#39; Computes z-score of a vector with numeric or logical values.</span></a>
<a class="sourceLine" id="cb69-5" data-line-number="5"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb69-6" data-line-number="6"><span class="co">#&#39; @param x A numeric or logical vector.</span></a>
<a class="sourceLine" id="cb69-7" data-line-number="7"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb69-8" data-line-number="8"><span class="co">#&#39; @return</span></a>
<a class="sourceLine" id="cb69-9" data-line-number="9"><span class="co">#&#39; The z-score of each value in x returned as a numeric vector of</span></a>
<a class="sourceLine" id="cb69-10" data-line-number="10"><span class="co">#&#39; with equal length as the input x vector.</span></a>
<a class="sourceLine" id="cb69-11" data-line-number="11"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb69-12" data-line-number="12"><span class="co">#&#39; @examples</span></a>
<a class="sourceLine" id="cb69-13" data-line-number="13"><span class="co">#&#39; x &lt;- 1:3</span></a>
<a class="sourceLine" id="cb69-14" data-line-number="14"><span class="co">#&#39; z_score(x)</span></a>
<a class="sourceLine" id="cb69-15" data-line-number="15"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb69-16" data-line-number="16"><span class="co">#&#39; @export</span></a>
<a class="sourceLine" id="cb69-17" data-line-number="17">z_score &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb69-18" data-line-number="18">  <span class="kw">return</span>((x <span class="op">-</span><span class="st"> </span><span class="kw">my_mean</span>(x)) <span class="op">/</span><span class="st"> </span><span class="kw">my_sd</span>(x))</a>
<a class="sourceLine" id="cb69-19" data-line-number="19">}</a></code></pre></div>
<p>Our <code>summary-stats.R</code> file should now include three functions in a top-down approach:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1"><span class="co">#&#39; Z-score of a vector</span></a>
<a class="sourceLine" id="cb70-2" data-line-number="2"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb70-3" data-line-number="3"><span class="co">#&#39; @description</span></a>
<a class="sourceLine" id="cb70-4" data-line-number="4"><span class="co">#&#39; Computes z-score of a vector with numeric or logical values.</span></a>
<a class="sourceLine" id="cb70-5" data-line-number="5"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb70-6" data-line-number="6"><span class="co">#&#39; @param x A numeric or logical vector.</span></a>
<a class="sourceLine" id="cb70-7" data-line-number="7"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb70-8" data-line-number="8"><span class="co">#&#39; @return</span></a>
<a class="sourceLine" id="cb70-9" data-line-number="9"><span class="co">#&#39; The z-score of each value in x returned as a numeric vector of</span></a>
<a class="sourceLine" id="cb70-10" data-line-number="10"><span class="co">#&#39; with equal length as the input x vector.</span></a>
<a class="sourceLine" id="cb70-11" data-line-number="11"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb70-12" data-line-number="12"><span class="co">#&#39; @examples</span></a>
<a class="sourceLine" id="cb70-13" data-line-number="13"><span class="co">#&#39; x &lt;- 1:3</span></a>
<a class="sourceLine" id="cb70-14" data-line-number="14"><span class="co">#&#39; z_score(x)</span></a>
<a class="sourceLine" id="cb70-15" data-line-number="15"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb70-16" data-line-number="16"><span class="co">#&#39; @export</span></a>
<a class="sourceLine" id="cb70-17" data-line-number="17">z_score &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb70-18" data-line-number="18">  <span class="kw">return</span>((x <span class="op">-</span><span class="st"> </span><span class="kw">my_mean</span>(x)) <span class="op">/</span><span class="st"> </span><span class="kw">my_sd</span>(x))</a>
<a class="sourceLine" id="cb70-19" data-line-number="19">}</a>
<a class="sourceLine" id="cb70-20" data-line-number="20"></a>
<a class="sourceLine" id="cb70-21" data-line-number="21"><span class="co">#&#39; Standard deviation of a vector</span></a>
<a class="sourceLine" id="cb70-22" data-line-number="22"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb70-23" data-line-number="23"><span class="co">#&#39; @description</span></a>
<a class="sourceLine" id="cb70-24" data-line-number="24"><span class="co">#&#39; Computes standard deviation of a vector with numeric or logical values.</span></a>
<a class="sourceLine" id="cb70-25" data-line-number="25"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb70-26" data-line-number="26"><span class="co">#&#39; @param x A numeric or logical vector.</span></a>
<a class="sourceLine" id="cb70-27" data-line-number="27"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb70-28" data-line-number="28"><span class="co">#&#39; @details</span></a>
<a class="sourceLine" id="cb70-29" data-line-number="29"><span class="co">#&#39; The denominator n - 1 is used which gives an unbiased estimator of the</span></a>
<a class="sourceLine" id="cb70-30" data-line-number="30"><span class="co">#&#39; (co)variance for i.i.d. observations.</span></a>
<a class="sourceLine" id="cb70-31" data-line-number="31"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb70-32" data-line-number="32"><span class="co">#&#39; @return</span></a>
<a class="sourceLine" id="cb70-33" data-line-number="33"><span class="co">#&#39; The standard deviation of the values in x returned as a numeric vector of</span></a>
<a class="sourceLine" id="cb70-34" data-line-number="34"><span class="co">#&#39; length one.</span></a>
<a class="sourceLine" id="cb70-35" data-line-number="35"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb70-36" data-line-number="36"><span class="co">#&#39; @examples</span></a>
<a class="sourceLine" id="cb70-37" data-line-number="37"><span class="co">#&#39; x &lt;- 1:10</span></a>
<a class="sourceLine" id="cb70-38" data-line-number="38"><span class="co">#&#39; my_sd(x)</span></a>
<a class="sourceLine" id="cb70-39" data-line-number="39"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb70-40" data-line-number="40"><span class="co">#&#39; @export</span></a>
<a class="sourceLine" id="cb70-41" data-line-number="41">my_sd &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb70-42" data-line-number="42">  <span class="kw">validate_numeric_vector</span>(x)</a>
<a class="sourceLine" id="cb70-43" data-line-number="43">  squared_diff &lt;-<span class="st"> </span>(x <span class="op">-</span><span class="st"> </span><span class="kw">my_mean</span>(x))<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb70-44" data-line-number="44">  total &lt;-<span class="st"> </span><span class="kw">sum</span>(squared_diff)</a>
<a class="sourceLine" id="cb70-45" data-line-number="45">  units &lt;-<span class="st"> </span><span class="kw">length</span>(x) <span class="op">-</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb70-46" data-line-number="46">  <span class="kw">return</span>(<span class="kw">sqrt</span>(total <span class="op">/</span><span class="st"> </span>units))</a>
<a class="sourceLine" id="cb70-47" data-line-number="47">}</a>
<a class="sourceLine" id="cb70-48" data-line-number="48"></a>
<a class="sourceLine" id="cb70-49" data-line-number="49"><span class="co">#&#39; Mean of a vector</span></a>
<a class="sourceLine" id="cb70-50" data-line-number="50"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb70-51" data-line-number="51"><span class="co">#&#39; @description</span></a>
<a class="sourceLine" id="cb70-52" data-line-number="52"><span class="co">#&#39; Computes arithmetic mean of a vector with numeric or logical values.</span></a>
<a class="sourceLine" id="cb70-53" data-line-number="53"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb70-54" data-line-number="54"><span class="co">#&#39; @param x A numeric or logical vector.</span></a>
<a class="sourceLine" id="cb70-55" data-line-number="55"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb70-56" data-line-number="56"><span class="co">#&#39; @return</span></a>
<a class="sourceLine" id="cb70-57" data-line-number="57"><span class="co">#&#39; The arithmetic mean of the values in x returned as a numeric vector of length one.</span></a>
<a class="sourceLine" id="cb70-58" data-line-number="58"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb70-59" data-line-number="59"><span class="co">#&#39; @examples</span></a>
<a class="sourceLine" id="cb70-60" data-line-number="60"><span class="co">#&#39; x &lt;- 1:10</span></a>
<a class="sourceLine" id="cb70-61" data-line-number="61"><span class="co">#&#39; my_mean(x)</span></a>
<a class="sourceLine" id="cb70-62" data-line-number="62"><span class="co">#&#39;</span></a>
<a class="sourceLine" id="cb70-63" data-line-number="63"><span class="co">#&#39; @export</span></a>
<a class="sourceLine" id="cb70-64" data-line-number="64">my_mean &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb70-65" data-line-number="65">  <span class="kw">validate_numeric_vector</span>(x)</a>
<a class="sourceLine" id="cb70-66" data-line-number="66">  total &lt;-<span class="st"> </span><span class="kw">sum</span>(x)</a>
<a class="sourceLine" id="cb70-67" data-line-number="67">  units &lt;-<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb70-68" data-line-number="68">  <span class="kw">return</span>(total <span class="op">/</span><span class="st"> </span>units)</a>
<a class="sourceLine" id="cb70-69" data-line-number="69">}</a></code></pre></div>
<p>And our <code>test-summary-stats.R</code> file should look like:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1"><span class="kw">test_that</span>(<span class="st">&quot;z-score of simple vector computes accurately&quot;</span>, {</a>
<a class="sourceLine" id="cb71-2" data-line-number="2">  x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb71-3" data-line-number="3">  expected &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb71-4" data-line-number="4">  <span class="kw">expect_equal</span>(<span class="kw">z_score</span>(x), expected)</a>
<a class="sourceLine" id="cb71-5" data-line-number="5">})</a>
<a class="sourceLine" id="cb71-6" data-line-number="6"></a>
<a class="sourceLine" id="cb71-7" data-line-number="7"><span class="kw">test_that</span>(<span class="st">&quot;standard deviation of simple vector computes accurately&quot;</span>, {</a>
<a class="sourceLine" id="cb71-8" data-line-number="8">  x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb71-9" data-line-number="9">  <span class="kw">expect_equal</span>(<span class="kw">my_sd</span>(x), <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb71-10" data-line-number="10">})</a>
<a class="sourceLine" id="cb71-11" data-line-number="11"></a>
<a class="sourceLine" id="cb71-12" data-line-number="12"><span class="kw">test_that</span>(<span class="st">&quot;mean of simple vector computes accurately&quot;</span>, {</a>
<a class="sourceLine" id="cb71-13" data-line-number="13">  x &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb71-14" data-line-number="14">  <span class="kw">expect_equal</span>(<span class="kw">my_mean</span>(x), <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb71-15" data-line-number="15">})</a></code></pre></div>
</div>
<div id="final-checks-version-control" class="section level3">
<h3><span class="header-section-number">6.3.5</span> Final checks &amp; version control</h3>
<p>Now before we commit our changes to git, let‚Äôs make sure everything is loaded and documented and passes our tests and checks:</p>
<ol style="list-style-type: decimal">
<li>document package functionality: <code>devtools::document()</code> or Cmd/Ctrl + Shift + D</li>
<li>load package functionality: <code>devtools::load_all()</code> or Cmd/Ctrl + Shift + L</li>
<li>test package functionality: <code>devtools::test()</code> or Cmd/Ctrl + Shift + T</li>
<li>R Cmd check package functionality: <code>devtools::check()</code> or Cmd/Ctrl + Shift + E</li>
</ol>
<p>As long as everything is passing, we can now commit our changes, push to Github and then do a pull request to incorporate our changes from our current working branch to the develop branch.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb72-1" data-line-number="1"><span class="fu">git</span> add -A</a>
<a class="sourceLine" id="cb72-2" data-line-number="2"><span class="fu">git</span> commit -m <span class="st">&#39;feat: add new validation &amp; summary stats</span></a>
<a class="sourceLine" id="cb72-3" data-line-number="3"><span class="st">&gt; Add validation function to ensure proper numeric vector input.</span></a>
<a class="sourceLine" id="cb72-4" data-line-number="4"><span class="st">&gt; Add summary stat functions to compute standard deviation and z-score.&#39;</span></a>
<a class="sourceLine" id="cb72-5" data-line-number="5"><span class="fu">git</span> push --set-upstream origin ch6</a></code></pre></div>
</div>
</div>
<div id="example-7" class="section level2">
<h2><span class="header-section-number">6.4</span> <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> example</h2>
<p>For a <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> package, all source code goes in the <code>src/pkgname/</code> directory. Unlike <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> packages, you can have subdirectories and submodules in <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> packages. However, for simplicity, we‚Äôll just include all source code at the <code>src/pkgname/</code> directory level.</p>
<p>Let‚Äôs add some functionality to our package to illustrate some points from our previous discussion. We‚Äôll take the same approach as in the <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 581 512"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"/></svg> example section and:</p>
<ul>
<li>add an internally-focused function that validates the user inputs,</li>
<li>add breadth to our package by adding additional summary statistics computations,</li>
<li>add aggregation to our package by adding a z-score computation that leverages other functions within our package.</li>
</ul>
<div class="note">
<p>
To simplify, we‚Äôll show the final functions and tests added rather than illustrate every step of the test-driven development process.
</p>
</div>
<div id="setup-1" class="section level3">
<h3><span class="header-section-number">6.4.1</span> Setup</h3>
<p>Before we start adding new functionality, let‚Äôs make sure the current code base is ready. Open up your Python project, activate your virtual environment, switch to the develop branch and make sure it is current with your remote repo:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb73-1" data-line-number="1"><span class="fu">git</span> checkout develop</a>
<a class="sourceLine" id="cb73-2" data-line-number="2"><span class="fu">git</span> pull</a></code></pre></div>
<p>Now let‚Äôs create a new branch to add this chapter‚Äôs new functionality. Usually you name the branch after the new functionality that you‚Äôre adding or a Github issue that you are addressing. In our case we can name the branch ‚Äúch6‚Äù since it‚Äôs related to this chapter.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb74-1" data-line-number="1"><span class="fu">git</span> checkout -b ch6</a></code></pre></div>
</div>
<div id="internal-function-1" class="section level3">
<h3><span class="header-section-number">6.4.2</span> Internal function</h3>
<p>First, we‚Äôll add an internally-focused function that validates the user inputs. Since we may continue to expand our package and add more validation procedures, we typically create a validation.R file to hold these functions.</p>
<p>Go ahead and create the test and .py file:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb75-1" data-line-number="1"><span class="fu">touch</span> tests/test_validation.py</a>
<a class="sourceLine" id="cb75-2" data-line-number="2"><span class="fu">touch</span> src/myfirstpypkg/validation.py</a></code></pre></div>
<p>Place the following in the <code>test_validation.py</code> test file:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb76-1" data-line-number="1"><span class="im">from</span> myfirstpypkg.validation <span class="im">import</span> _validate_numeric_sequence</a>
<a class="sourceLine" id="cb76-2" data-line-number="2"><span class="im">import</span> pytest</a>
<a class="sourceLine" id="cb76-3" data-line-number="3"></a>
<a class="sourceLine" id="cb76-4" data-line-number="4"></a>
<a class="sourceLine" id="cb76-5" data-line-number="5"><span class="kw">def</span> test_validate_sequence_numeric():</a>
<a class="sourceLine" id="cb76-6" data-line-number="6">    <span class="cf">assert</span> _validate_numeric_sequence(<span class="bu">range</span>(<span class="dv">10</span>)) <span class="op">==</span> <span class="va">None</span></a>
<a class="sourceLine" id="cb76-7" data-line-number="7">    <span class="cf">with</span> pytest.raises(<span class="pp">TypeError</span>):</a>
<a class="sourceLine" id="cb76-8" data-line-number="8">        _validate_numeric_sequence(<span class="bu">list</span>(<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>))</a>
<a class="sourceLine" id="cb76-9" data-line-number="9"></a>
<a class="sourceLine" id="cb76-10" data-line-number="10"><span class="kw">def</span> test_validate_sequence_type():</a>
<a class="sourceLine" id="cb76-11" data-line-number="11">    <span class="cf">with</span> pytest.raises(<span class="pp">TypeError</span>):</a>
<a class="sourceLine" id="cb76-12" data-line-number="12">        _validate_numeric_sequence({})</a></code></pre></div>
<p>and the following in the <code>validation.py</code> source code file:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb77-1" data-line-number="1"><span class="im">from</span> collections <span class="im">import</span> Sequence</a>
<a class="sourceLine" id="cb77-2" data-line-number="2"></a>
<a class="sourceLine" id="cb77-3" data-line-number="3"><span class="kw">def</span> _validate_numeric_sequence(x):</a>
<a class="sourceLine" id="cb77-4" data-line-number="4">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb77-5" data-line-number="5"><span class="co">    Validate numeric sequence input</span></a>
<a class="sourceLine" id="cb77-6" data-line-number="6"></a>
<a class="sourceLine" id="cb77-7" data-line-number="7"><span class="co">    Checks that an in put is a sequence that contains numeric inputs or</span></a>
<a class="sourceLine" id="cb77-8" data-line-number="8"><span class="co">    logical values that can be coerced to numeric values.</span></a>
<a class="sourceLine" id="cb77-9" data-line-number="9"></a>
<a class="sourceLine" id="cb77-10" data-line-number="10"><span class="co">    Parameters</span></a>
<a class="sourceLine" id="cb77-11" data-line-number="11"><span class="co">    ----------</span></a>
<a class="sourceLine" id="cb77-12" data-line-number="12"><span class="co">    x</span></a>
<a class="sourceLine" id="cb77-13" data-line-number="13"><span class="co">        A numeric or logical vector.</span></a>
<a class="sourceLine" id="cb77-14" data-line-number="14"></a>
<a class="sourceLine" id="cb77-15" data-line-number="15"><span class="co">    Returns</span></a>
<a class="sourceLine" id="cb77-16" data-line-number="16"><span class="co">    -------</span></a>
<a class="sourceLine" id="cb77-17" data-line-number="17"><span class="co">    None</span></a>
<a class="sourceLine" id="cb77-18" data-line-number="18"></a>
<a class="sourceLine" id="cb77-19" data-line-number="19"><span class="co">    Raises</span></a>
<a class="sourceLine" id="cb77-20" data-line-number="20"><span class="co">    ------</span></a>
<a class="sourceLine" id="cb77-21" data-line-number="21"><span class="co">    TypeError</span></a>
<a class="sourceLine" id="cb77-22" data-line-number="22"><span class="co">        If `x` is not a sequence of type float, int or bool.</span></a>
<a class="sourceLine" id="cb77-23" data-line-number="23"></a>
<a class="sourceLine" id="cb77-24" data-line-number="24"><span class="co">    Examples</span></a>
<a class="sourceLine" id="cb77-25" data-line-number="25"><span class="co">    --------</span></a>
<a class="sourceLine" id="cb77-26" data-line-number="26"><span class="co">    x = range(10)</span></a>
<a class="sourceLine" id="cb77-27" data-line-number="27"><span class="co">    _validate_numeric_sequence(x)</span></a>
<a class="sourceLine" id="cb77-28" data-line-number="28"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb77-29" data-line-number="29">    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(x, (Sequence, <span class="bu">float</span>, <span class="bu">int</span>, <span class="bu">bool</span>)):</a>
<a class="sourceLine" id="cb77-30" data-line-number="30">        <span class="cf">raise</span> <span class="pp">TypeError</span>(<span class="st">&quot;`x` must be a sequence of type float, int, or bool.&quot;</span>)</a></code></pre></div>
<p>Two important items to note in the above:</p>
<ol style="list-style-type: decimal">
<li>We start the function with an underscore <code>_validate...</code>. In Python, we cannot hide internal functions from end-users; however, it is Pythonic to start all functions designed for internal use with an underscore.</li>
<li>Even though this is an internal function, we still document it as normal. This isn‚Äôt required but it helps us and contributing developers understand the purpose of the function.</li>
</ol>
<div class="tip">
<p>
Remember, as we add new code we always want to be running the tests with <code>pytest</code>.
</p>
</div>
<p>Now before adding any new functionality, let‚Äôs add this validation function to our existing <code>my_mean()</code> function. Your <code>mean.py</code> file should look like below. Note that we use a relative import to import <code>_validate_numeric_sequence</code> from the <code>validation.py</code> module.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb78-1" data-line-number="1"><span class="im">from</span> .validation <span class="im">import</span> _validate_numeric_sequence</a>
<a class="sourceLine" id="cb78-2" data-line-number="2"></a>
<a class="sourceLine" id="cb78-3" data-line-number="3"></a>
<a class="sourceLine" id="cb78-4" data-line-number="4"><span class="kw">def</span> my_mean(x):</a>
<a class="sourceLine" id="cb78-5" data-line-number="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb78-6" data-line-number="6"><span class="co">    Mean of a vector</span></a>
<a class="sourceLine" id="cb78-7" data-line-number="7"></a>
<a class="sourceLine" id="cb78-8" data-line-number="8"><span class="co">    Computes arithmetic mean of a vector with numeric or logical values.</span></a>
<a class="sourceLine" id="cb78-9" data-line-number="9"></a>
<a class="sourceLine" id="cb78-10" data-line-number="10"><span class="co">    Parameters</span></a>
<a class="sourceLine" id="cb78-11" data-line-number="11"><span class="co">    ----------</span></a>
<a class="sourceLine" id="cb78-12" data-line-number="12"><span class="co">    x</span></a>
<a class="sourceLine" id="cb78-13" data-line-number="13"><span class="co">        A numeric or logical list.</span></a>
<a class="sourceLine" id="cb78-14" data-line-number="14"></a>
<a class="sourceLine" id="cb78-15" data-line-number="15"><span class="co">    Returns</span></a>
<a class="sourceLine" id="cb78-16" data-line-number="16"><span class="co">    -------</span></a>
<a class="sourceLine" id="cb78-17" data-line-number="17"><span class="co">    The arithmetic mean of the values in x returned as a numeric vector of length one.</span></a>
<a class="sourceLine" id="cb78-18" data-line-number="18"></a>
<a class="sourceLine" id="cb78-19" data-line-number="19"><span class="co">    Examples</span></a>
<a class="sourceLine" id="cb78-20" data-line-number="20"><span class="co">    --------</span></a>
<a class="sourceLine" id="cb78-21" data-line-number="21"><span class="co">    &gt;&gt;&gt; x = range(0, 11)</span></a>
<a class="sourceLine" id="cb78-22" data-line-number="22"><span class="co">    ... my_mean(x)</span></a>
<a class="sourceLine" id="cb78-23" data-line-number="23"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb78-24" data-line-number="24">    _validate_numeric_sequence(x)</a>
<a class="sourceLine" id="cb78-25" data-line-number="25">    total <span class="op">=</span> <span class="bu">sum</span>(x)</a>
<a class="sourceLine" id="cb78-26" data-line-number="26">    units <span class="op">=</span> <span class="bu">len</span>(x)</a>
<a class="sourceLine" id="cb78-27" data-line-number="27">    <span class="cf">return</span> total <span class="op">/</span> units</a></code></pre></div>
</div>
<div id="adding-breadth-1" class="section level3">
<h3><span class="header-section-number">6.4.3</span> Adding breadth</h3>
<p>Next, let‚Äôs add a new summary statistic to our collection. For now, we‚Äôll store this summary statistic in the same file but in the future if this file became too large we may look to refactor and split up the centralized organization. Let‚Äôs rename the original <code>mean.py</code> file to <code>summary_stats.py</code> and also rename the associated test file to <code>test_summary_stats.py</code>.</p>
<div class="note">
<p>
It is common to rename files and functions as you begin developing a package since you are feeling out what the best design and organization will be but as your package matures this will happen less frequently.
</p>
</div>
<p>Now we‚Äôll add a function that computes the standard deviation. Update your <code>test_summary_stats.py</code> file to look like:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb79-1" data-line-number="1"><span class="im">from</span> myfirstpypkg.summary_stats <span class="im">import</span> my_mean</a>
<a class="sourceLine" id="cb79-2" data-line-number="2"><span class="im">from</span> myfirstpypkg.summary_stats <span class="im">import</span> my_sd</a>
<a class="sourceLine" id="cb79-3" data-line-number="3"></a>
<a class="sourceLine" id="cb79-4" data-line-number="4"></a>
<a class="sourceLine" id="cb79-5" data-line-number="5"><span class="kw">def</span> test_my_sd():</a>
<a class="sourceLine" id="cb79-6" data-line-number="6">    x <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</a>
<a class="sourceLine" id="cb79-7" data-line-number="7">    <span class="cf">assert</span> my_sd(x) <span class="op">==</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb79-8" data-line-number="8"></a>
<a class="sourceLine" id="cb79-9" data-line-number="9"><span class="kw">def</span> test_my_mean():</a>
<a class="sourceLine" id="cb79-10" data-line-number="10">    x <span class="op">=</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">11</span>)</a>
<a class="sourceLine" id="cb79-11" data-line-number="11">    <span class="cf">assert</span> my_mean(x) <span class="op">==</span> <span class="dv">5</span></a></code></pre></div>
<p>and add the following to the <code>summary_stats.py</code> file in the <code>src/myfirstpypkg/</code> directory:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb80-1" data-line-number="1"><span class="im">from</span> math <span class="im">import</span> sqrt</a>
<a class="sourceLine" id="cb80-2" data-line-number="2"></a>
<a class="sourceLine" id="cb80-3" data-line-number="3"></a>
<a class="sourceLine" id="cb80-4" data-line-number="4"><span class="kw">def</span> my_sd(x):</a>
<a class="sourceLine" id="cb80-5" data-line-number="5">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb80-6" data-line-number="6"><span class="co">    Standard deviation of a sequence</span></a>
<a class="sourceLine" id="cb80-7" data-line-number="7"></a>
<a class="sourceLine" id="cb80-8" data-line-number="8"><span class="co">    Computes standard deviation of a vector with numeric or logical values. The</span></a>
<a class="sourceLine" id="cb80-9" data-line-number="9"><span class="co">    denominator `units = len(x) - 1` is used which gives an unbiased estimator</span></a>
<a class="sourceLine" id="cb80-10" data-line-number="10"><span class="co">    of the (co)variance for i.i.d. observations.</span></a>
<a class="sourceLine" id="cb80-11" data-line-number="11"></a>
<a class="sourceLine" id="cb80-12" data-line-number="12"><span class="co">    Parameters</span></a>
<a class="sourceLine" id="cb80-13" data-line-number="13"><span class="co">    ----------</span></a>
<a class="sourceLine" id="cb80-14" data-line-number="14"><span class="co">    x</span></a>
<a class="sourceLine" id="cb80-15" data-line-number="15"><span class="co">        A numeric or logical sequence.</span></a>
<a class="sourceLine" id="cb80-16" data-line-number="16"></a>
<a class="sourceLine" id="cb80-17" data-line-number="17"><span class="co">    Returns</span></a>
<a class="sourceLine" id="cb80-18" data-line-number="18"><span class="co">    -------</span></a>
<a class="sourceLine" id="cb80-19" data-line-number="19"><span class="co">    The standard deviation of the values in x returned as a numeric value of length one.</span></a>
<a class="sourceLine" id="cb80-20" data-line-number="20"></a>
<a class="sourceLine" id="cb80-21" data-line-number="21"><span class="co">    Examples</span></a>
<a class="sourceLine" id="cb80-22" data-line-number="22"><span class="co">    --------</span></a>
<a class="sourceLine" id="cb80-23" data-line-number="23"><span class="co">    &gt;&gt;&gt; x = [1, 2, 3]</span></a>
<a class="sourceLine" id="cb80-24" data-line-number="24"><span class="co">    ... my_sd(x)</span></a>
<a class="sourceLine" id="cb80-25" data-line-number="25"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb80-26" data-line-number="26">    _validate_numeric_sequence(x)</a>
<a class="sourceLine" id="cb80-27" data-line-number="27">    mu <span class="op">=</span> my_mean(x)</a>
<a class="sourceLine" id="cb80-28" data-line-number="28">    squared_diff <span class="op">=</span> [(i <span class="op">-</span> mu)<span class="op">**</span><span class="dv">2</span> <span class="cf">for</span> i <span class="kw">in</span> x]</a>
<a class="sourceLine" id="cb80-29" data-line-number="29">    total <span class="op">=</span> <span class="bu">sum</span>(squared_diff)</a>
<a class="sourceLine" id="cb80-30" data-line-number="30">    units <span class="op">=</span> <span class="bu">len</span>(x) <span class="op">-</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb80-31" data-line-number="31">    <span class="cf">return</span>(sqrt(total <span class="op">/</span> units))</a></code></pre></div>
</div>
<div id="adding-aggregation-1" class="section level3">
<h3><span class="header-section-number">6.4.4</span> Adding aggregation</h3>
<p>Last, we‚Äôll add a new summary statistics, the z-score, that leverages the <code>my_mean</code> and <code>my_sd</code> functions. Since this is adding onto our level of abstraction we‚Äôll place this at the top of our <code>src/myfirstpypkg/summary_stats.py</code> file.</p>
<p>Add a z-score test to the <code>test_summary_stats.py</code> file:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb81-1" data-line-number="1"><span class="kw">def</span> test_z_score():</a>
<a class="sourceLine" id="cb81-2" data-line-number="2">    x <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</a>
<a class="sourceLine" id="cb81-3" data-line-number="3">    expected <span class="op">=</span> [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb81-4" data-line-number="4">    <span class="cf">assert</span> z_score(x) <span class="op">==</span> expected</a></code></pre></div>
<p>and add the following to the <code>summary_stats.py</code> file in the <code>src/myfirstpypkg/</code> directory:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb82-1" data-line-number="1"><span class="kw">def</span> z_score(x):</a>
<a class="sourceLine" id="cb82-2" data-line-number="2">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb82-3" data-line-number="3"><span class="co">    Z-score of a sequence</span></a>
<a class="sourceLine" id="cb82-4" data-line-number="4"></a>
<a class="sourceLine" id="cb82-5" data-line-number="5"><span class="co">    Computes the z-score of a sequence with numeric or logical values.</span></a>
<a class="sourceLine" id="cb82-6" data-line-number="6"></a>
<a class="sourceLine" id="cb82-7" data-line-number="7"><span class="co">    Parameters</span></a>
<a class="sourceLine" id="cb82-8" data-line-number="8"><span class="co">    ----------</span></a>
<a class="sourceLine" id="cb82-9" data-line-number="9"><span class="co">    x</span></a>
<a class="sourceLine" id="cb82-10" data-line-number="10"><span class="co">        A numeric or logical sequence.</span></a>
<a class="sourceLine" id="cb82-11" data-line-number="11"></a>
<a class="sourceLine" id="cb82-12" data-line-number="12"><span class="co">    Returns</span></a>
<a class="sourceLine" id="cb82-13" data-line-number="13"><span class="co">    -------</span></a>
<a class="sourceLine" id="cb82-14" data-line-number="14"><span class="co">    The z-score for each value in x as a list.</span></a>
<a class="sourceLine" id="cb82-15" data-line-number="15"></a>
<a class="sourceLine" id="cb82-16" data-line-number="16"><span class="co">    Examples</span></a>
<a class="sourceLine" id="cb82-17" data-line-number="17"><span class="co">    --------</span></a>
<a class="sourceLine" id="cb82-18" data-line-number="18"><span class="co">    &gt;&gt;&gt; x = [1, 2, 3]</span></a>
<a class="sourceLine" id="cb82-19" data-line-number="19"><span class="co">    ... z_score(x)</span></a>
<a class="sourceLine" id="cb82-20" data-line-number="20"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb82-21" data-line-number="21">    mu <span class="op">=</span> my_mean(x)</a>
<a class="sourceLine" id="cb82-22" data-line-number="22">    sd <span class="op">=</span> my_sd(x)</a>
<a class="sourceLine" id="cb82-23" data-line-number="23">    <span class="cf">return</span> [((i <span class="op">-</span> mu) <span class="op">/</span> sd) <span class="cf">for</span> i <span class="kw">in</span> x]</a></code></pre></div>
<p>Our <code>summary_stats.py</code> file should now include three functions in a top-down approach:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb83-1" data-line-number="1"><span class="im">from</span> .validation <span class="im">import</span> _validate_numeric_sequence</a>
<a class="sourceLine" id="cb83-2" data-line-number="2"><span class="im">from</span> math <span class="im">import</span> sqrt</a>
<a class="sourceLine" id="cb83-3" data-line-number="3"></a>
<a class="sourceLine" id="cb83-4" data-line-number="4"></a>
<a class="sourceLine" id="cb83-5" data-line-number="5"><span class="kw">def</span> z_score(x):</a>
<a class="sourceLine" id="cb83-6" data-line-number="6">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb83-7" data-line-number="7"><span class="co">    Z-score of a sequence</span></a>
<a class="sourceLine" id="cb83-8" data-line-number="8"></a>
<a class="sourceLine" id="cb83-9" data-line-number="9"><span class="co">    Computes the z-score of a sequence with numeric or logical values.</span></a>
<a class="sourceLine" id="cb83-10" data-line-number="10"></a>
<a class="sourceLine" id="cb83-11" data-line-number="11"><span class="co">    Parameters</span></a>
<a class="sourceLine" id="cb83-12" data-line-number="12"><span class="co">    ----------</span></a>
<a class="sourceLine" id="cb83-13" data-line-number="13"><span class="co">    x</span></a>
<a class="sourceLine" id="cb83-14" data-line-number="14"><span class="co">        A numeric or logical sequence.</span></a>
<a class="sourceLine" id="cb83-15" data-line-number="15"></a>
<a class="sourceLine" id="cb83-16" data-line-number="16"><span class="co">    Returns</span></a>
<a class="sourceLine" id="cb83-17" data-line-number="17"><span class="co">    -------</span></a>
<a class="sourceLine" id="cb83-18" data-line-number="18"><span class="co">    The z-score for each value in x as a list.</span></a>
<a class="sourceLine" id="cb83-19" data-line-number="19"></a>
<a class="sourceLine" id="cb83-20" data-line-number="20"><span class="co">    Examples</span></a>
<a class="sourceLine" id="cb83-21" data-line-number="21"><span class="co">    --------</span></a>
<a class="sourceLine" id="cb83-22" data-line-number="22"><span class="co">    &gt;&gt;&gt; x = [1, 2, 3]</span></a>
<a class="sourceLine" id="cb83-23" data-line-number="23"><span class="co">    ... z_score(x)</span></a>
<a class="sourceLine" id="cb83-24" data-line-number="24"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb83-25" data-line-number="25">    mu <span class="op">=</span> my_mean(x)</a>
<a class="sourceLine" id="cb83-26" data-line-number="26">    sd <span class="op">=</span> my_sd(x)</a>
<a class="sourceLine" id="cb83-27" data-line-number="27">    <span class="cf">return</span> [((i <span class="op">-</span> mu) <span class="op">/</span> sd) <span class="cf">for</span> i <span class="kw">in</span> x]</a>
<a class="sourceLine" id="cb83-28" data-line-number="28"></a>
<a class="sourceLine" id="cb83-29" data-line-number="29"><span class="kw">def</span> my_sd(x):</a>
<a class="sourceLine" id="cb83-30" data-line-number="30">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb83-31" data-line-number="31"><span class="co">    Standard deviation of a sequence</span></a>
<a class="sourceLine" id="cb83-32" data-line-number="32"></a>
<a class="sourceLine" id="cb83-33" data-line-number="33"><span class="co">    Computes standard deviation of a sequence with numeric or logical values.</span></a>
<a class="sourceLine" id="cb83-34" data-line-number="34"><span class="co">    The denominator `units = len(x) - 1` is used which gives an unbiased</span></a>
<a class="sourceLine" id="cb83-35" data-line-number="35"><span class="co">    estimator of the (co)variance for i.i.d. observations.</span></a>
<a class="sourceLine" id="cb83-36" data-line-number="36"></a>
<a class="sourceLine" id="cb83-37" data-line-number="37"><span class="co">    Parameters</span></a>
<a class="sourceLine" id="cb83-38" data-line-number="38"><span class="co">    ----------</span></a>
<a class="sourceLine" id="cb83-39" data-line-number="39"><span class="co">    x</span></a>
<a class="sourceLine" id="cb83-40" data-line-number="40"><span class="co">        A numeric or logical sequence.</span></a>
<a class="sourceLine" id="cb83-41" data-line-number="41"></a>
<a class="sourceLine" id="cb83-42" data-line-number="42"><span class="co">    Returns</span></a>
<a class="sourceLine" id="cb83-43" data-line-number="43"><span class="co">    -------</span></a>
<a class="sourceLine" id="cb83-44" data-line-number="44"><span class="co">    The standard deviation of the values in x returned as a numeric value of length one.</span></a>
<a class="sourceLine" id="cb83-45" data-line-number="45"></a>
<a class="sourceLine" id="cb83-46" data-line-number="46"><span class="co">    Examples</span></a>
<a class="sourceLine" id="cb83-47" data-line-number="47"><span class="co">    --------</span></a>
<a class="sourceLine" id="cb83-48" data-line-number="48"><span class="co">    &gt;&gt;&gt; x = [1, 2, 3]</span></a>
<a class="sourceLine" id="cb83-49" data-line-number="49"><span class="co">    ... my_sd(x)</span></a>
<a class="sourceLine" id="cb83-50" data-line-number="50"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb83-51" data-line-number="51">    _validate_numeric_sequence(x)</a>
<a class="sourceLine" id="cb83-52" data-line-number="52">    mu <span class="op">=</span> my_mean(x)</a>
<a class="sourceLine" id="cb83-53" data-line-number="53">    squared_diff <span class="op">=</span> [(i <span class="op">-</span> mu)<span class="op">**</span><span class="dv">2</span> <span class="cf">for</span> i <span class="kw">in</span> x]</a>
<a class="sourceLine" id="cb83-54" data-line-number="54">    total <span class="op">=</span> <span class="bu">sum</span>(squared_diff)</a>
<a class="sourceLine" id="cb83-55" data-line-number="55">    units <span class="op">=</span> <span class="bu">len</span>(x) <span class="op">-</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb83-56" data-line-number="56">    <span class="cf">return</span>(sqrt(total <span class="op">/</span> units))</a>
<a class="sourceLine" id="cb83-57" data-line-number="57"></a>
<a class="sourceLine" id="cb83-58" data-line-number="58"><span class="kw">def</span> my_mean(x):</a>
<a class="sourceLine" id="cb83-59" data-line-number="59">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb83-60" data-line-number="60"><span class="co">    Mean of a sequence</span></a>
<a class="sourceLine" id="cb83-61" data-line-number="61"></a>
<a class="sourceLine" id="cb83-62" data-line-number="62"><span class="co">    Computes arithmetic mean of a sequence with numeric or logical values.</span></a>
<a class="sourceLine" id="cb83-63" data-line-number="63"></a>
<a class="sourceLine" id="cb83-64" data-line-number="64"><span class="co">    Parameters</span></a>
<a class="sourceLine" id="cb83-65" data-line-number="65"><span class="co">    ----------</span></a>
<a class="sourceLine" id="cb83-66" data-line-number="66"><span class="co">    x</span></a>
<a class="sourceLine" id="cb83-67" data-line-number="67"><span class="co">        A numeric or logical sequence.</span></a>
<a class="sourceLine" id="cb83-68" data-line-number="68"></a>
<a class="sourceLine" id="cb83-69" data-line-number="69"><span class="co">    Returns</span></a>
<a class="sourceLine" id="cb83-70" data-line-number="70"><span class="co">    -------</span></a>
<a class="sourceLine" id="cb83-71" data-line-number="71"><span class="co">    The arithmetic mean of the values in x returned as a numeric value of length one.</span></a>
<a class="sourceLine" id="cb83-72" data-line-number="72"></a>
<a class="sourceLine" id="cb83-73" data-line-number="73"><span class="co">    Examples</span></a>
<a class="sourceLine" id="cb83-74" data-line-number="74"><span class="co">    --------</span></a>
<a class="sourceLine" id="cb83-75" data-line-number="75"><span class="co">    &gt;&gt;&gt; x = range(0, 11)</span></a>
<a class="sourceLine" id="cb83-76" data-line-number="76"><span class="co">    ... my_mean(x)</span></a>
<a class="sourceLine" id="cb83-77" data-line-number="77"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb83-78" data-line-number="78">    _validate_numeric_sequence(x)</a>
<a class="sourceLine" id="cb83-79" data-line-number="79">    total <span class="op">=</span> <span class="bu">sum</span>(x)</a>
<a class="sourceLine" id="cb83-80" data-line-number="80">    units <span class="op">=</span> <span class="bu">len</span>(x)</a>
<a class="sourceLine" id="cb83-81" data-line-number="81">    <span class="cf">return</span> total <span class="op">/</span> units</a></code></pre></div>
<p>And our <code>test_summary_stats.py</code> file should look like:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb84-1" data-line-number="1"><span class="im">from</span> myfirstpypkg.summary_stats <span class="im">import</span> my_mean</a>
<a class="sourceLine" id="cb84-2" data-line-number="2"><span class="im">from</span> myfirstpypkg.summary_stats <span class="im">import</span> my_sd</a>
<a class="sourceLine" id="cb84-3" data-line-number="3"><span class="im">from</span> myfirstpypkg.summary_stats <span class="im">import</span> z_score</a>
<a class="sourceLine" id="cb84-4" data-line-number="4"></a>
<a class="sourceLine" id="cb84-5" data-line-number="5"></a>
<a class="sourceLine" id="cb84-6" data-line-number="6"><span class="kw">def</span> test_z_score():</a>
<a class="sourceLine" id="cb84-7" data-line-number="7">    x <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</a>
<a class="sourceLine" id="cb84-8" data-line-number="8">    expected <span class="op">=</span> [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb84-9" data-line-number="9">    <span class="cf">assert</span> z_score(x) <span class="op">==</span> expected</a>
<a class="sourceLine" id="cb84-10" data-line-number="10"></a>
<a class="sourceLine" id="cb84-11" data-line-number="11"><span class="kw">def</span> test_my_sd():</a>
<a class="sourceLine" id="cb84-12" data-line-number="12">    x <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</a>
<a class="sourceLine" id="cb84-13" data-line-number="13">    <span class="cf">assert</span> my_sd(x) <span class="op">==</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb84-14" data-line-number="14"></a>
<a class="sourceLine" id="cb84-15" data-line-number="15"><span class="kw">def</span> test_my_mean():</a>
<a class="sourceLine" id="cb84-16" data-line-number="16">    x <span class="op">=</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="dv">11</span>)</a>
<a class="sourceLine" id="cb84-17" data-line-number="17">    <span class="cf">assert</span> my_mean(x) <span class="op">==</span> <span class="dv">5</span></a></code></pre></div>
</div>
<div id="simplify-user-access" class="section level3">
<h3><span class="header-section-number">6.4.5</span> Simplify user access</h3>
<p>With <svg style="height:0.8em;top:.04em;position:relative;" viewBox="0 0 448 512"><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg> packages, users access objects with a module namespace approach. This means, since our <code>z_score()</code> function is located at:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb85-1" data-line-number="1"><span class="ex">.</span></a>
<a class="sourceLine" id="cb85-2" data-line-number="2">‚îî‚îÄ‚îÄ <span class="ex">src/myfirstpypkg</span></a>
<a class="sourceLine" id="cb85-3" data-line-number="3">    ‚îî‚îÄ‚îÄ <span class="ex">summary_stats.py</span></a></code></pre></div>
<p>When they use our package they would have to access this function with one of the following:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb86-1" data-line-number="1"><span class="im">import</span> myfirstpypkg</a>
<a class="sourceLine" id="cb86-2" data-line-number="2"></a>
<a class="sourceLine" id="cb86-3" data-line-number="3">myfirstpypkg.summary_stats.z_score(x)</a></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb87-1" data-line-number="1"><span class="im">from</span> myfirstpypkg.summary_stats <span class="im">import</span> z_score</a>
<a class="sourceLine" id="cb87-2" data-line-number="2"></a>
<a class="sourceLine" id="cb87-3" data-line-number="3">z_score(x)</a></code></pre></div>
<p>We can simplify this for the users by exporting the <code>z_score()</code> function so the user can simply do:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb88-1" data-line-number="1"><span class="im">from</span> myfirstpypkg <span class="im">import</span> z_score</a>
<a class="sourceLine" id="cb88-2" data-line-number="2"></a>
<a class="sourceLine" id="cb88-3" data-line-number="3">z_score(x)</a></code></pre></div>
<p>To allow for this you simply add the following to the <code>src/myfirstpypkg/__init__.py</code> file:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb89-1" data-line-number="1"><span class="im">from</span> .summary_stats <span class="im">import</span> z_score</a></code></pre></div>
</div>
<div id="final-checks-version-control-1" class="section level3">
<h3><span class="header-section-number">6.4.6</span> Final checks &amp; version control</h3>
<p>Now before we commit our changes to git, let‚Äôs make sure everything still loads appropriately and passes all tests:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb90-1" data-line-number="1"><span class="ex">pip</span> install -e .</a>
<a class="sourceLine" id="cb90-2" data-line-number="2"><span class="ex">pytest</span></a></code></pre></div>
<p>As long as everything is passing, we can now commit our changes, push to Github and then do a pull request to incorporate our changes from our current working branch to the develop branch.</p>
<p>```bash
git add -A
git commit -m ‚Äòfeat: add new validation &amp; summary stats
&gt; Add validation function to ensure proper numeric sequence input.
&gt; Add summary stat functions to compute standard deviation and z-score.‚Äô
git push ‚Äìset-upstream origin ch6</p>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Subdirectories are actually allowed but they can only be for OS-specific purposes and named <code>unit/</code> or <code>windows/</code>. See this <a href="https://stackoverflow.com/questions/14902199/using-source-subdirectories-within-r-packages-with-roxygen2">Stackoverflow question</a> for details.<a href="code.html#fnref1" class="footnote-back">‚Ü©</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="metadata.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="test.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/bradleyboehmke/misk-packages/edit/master/05-source-code.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
