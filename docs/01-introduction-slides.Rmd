---
title: "Delivering Data Science Products via Packages"
author: "Misk Academy"
date: "2020-6-26"
output:
  xaringan::moon_reader:
    includes:
      after_body: insert-logo.html
    css: ["custom.css", "style.css"]
    self_contained: false
    lib_dir: libs
    chakra: libs/remark-latest.min.js
    nature:
      ratio: '16:9'
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
    seal: false
---

class: misk-title-slide   
<a href="https://github.com/misk-data-science/misk-packages"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a>


<br><br><br><br>
# .font120[Delivering Data Science Products<br>via Packages]

---
class: misk-section-slide 

<br><br><br><br><br><br><br>
.bold.font250[Introduction]

---
# What are packages?

* Packages are the fundamental units of reproducible R and Python code. 

* They include reusable components, the documentation that describes how to use them, requirements to ensure the user can apply them and tests to ensure consistent and reliable functionality.


```{block, type='note'}
.font80[
People often use the terms "package" and "library" synonymously.

- __package__: generally refers to source code that is bundled up in a way that a package manager can host. [PyPI](https://pypi.org/) and [CRAN](https://cran.r-project.org/) are the two primary public package managers for Python and R. When you `pip install pkg` (Python) or `install.packages("pkg")` (R) you are installing the __pkg__ package from a package manager onto a computer.

- __library__: generally refers to a centralized location on an operating system where installed package source code resides and can be imported into a current session (i.e. /usr/lib/R/library).  When you use `pip list` (Python) or `installed.packages()` (R) you will see a list of _installed_ packages, which we refer to as libraries. When you run `sys.path` (Python) or `.libPaths()` (R) you will get the path to the library where your installed packages are stored.
]
```


---
# Packaging

.pull-left.font120[

.bold[Why?]

- To share with others

- Reproducibility

- Track changes

- Communication

- Reliability

- Production
]

--

.pull-left.font120[

.bold[Why not?]

- Exploratory analysis

- One-off projects

- Small scripts

<br>
.center.font90.red[___Although the above type of work may not justify a package, it often still justifies good software engineering practices such as modularity and unit tests!___]

]

---
# Things to be aware of

* Several approaches and strategies to writing packages

* This course demonstrates commonly accepted best practices

* __Objective__: provide you with a short runway to writing packages as quickly as possible while following commonly used best practices

--

<br>

```{block, type='note'}
This is a lot to learn, but don’t feel overwhelmed. Start with a minimal subset of useful features and build up over time.
```

---
# Conventions used throughout

.font120[
- Python: `r fontawesome::fa("python")`
- R: `r fontawesome::fa("r-project")`
]

```{block, type = "tip"}
Signifies a tip or suggestion
```

```{block, type = "note"}
Signifies a general note
```

```{block, type = "warning"}
Signifies a warning or caution
```

---
# Exercises

<br>

1. Skim the table of contents for the following "official guides" to `r fontawesome::fa("r-project")` and `r fontawesome::fa("python")` packaging. Do not worry about reading the details but realize that these are good sources to start looking at when you have questions about certain aspects of packaging.
   - `r fontawesome::fa("r-project")`: [Creating R Extensions](https://cran.r-project.org/doc/manuals/R-exts.html#Creating-R-packages)
   - `r fontawesome::fa("python")`: [Python Packaging User Guide](https://packaging.python.org/)

2. Identify two popular `r fontawesome::fa("r-project")` packages and explain why packaging these capabilities is beneficial.

3. Identify two popular `r fontawesome::fa("python")` packages and explain why packaging these capabilities is beneficial.

---
class: misk-section-slide 

<br><br><br><br><br><br><br>
.bold.font250[Package Structure]

---
# Basic required files

.pull-left[

Minimum files required or highly suggested:

* Package metadata

* Source code directory

* Test directory

* Documentation directory

* License file

* Changelog

* README

* Other various config or requirement files

]

.pull-right[

```sh
.
├── package metadata file
├── source code directory
│   ├── script 1
│   ├── script 2
│   └── script n
├── test directory
│   ├── script 1
│   ├── script 2
│   └── script n
├── documentation directory
│   └── various doc files
├── license file
├── changelog file
├── README
└── other various config files and components
```

]

---
class: inverse

<br><br><br><br><br>
.center.white.font200[Let's assume a package called .bold.red[mypkg]]

---
# `r fontawesome::fa("r-project", fill = "white")` file structure

.pull-left[

Unique items here are:

- __DESCRIPTION__: This is the file that contains the primary package metadata.
- __R/__: The R directory is where all the source code resides.
- __NEWS__: It is common convention in many R packages to title the changelog as "NEWS".

]

.pull-right[

```sh
mypkg
├── DESCRIPTION
├── R/
├── tests/
├── docs/
├── LICENSE
├── NEWS
└── README
```

]

---
# `r fontawesome::fa("python", fill = "white")` file structure

.pull-left[

Unique items here are:

- __setup.py__: This is the file that contains the primary package metadata.
- __src/__: The src directory is where all the source code resides.

]

.pull-right[

```sh
mypkg
├── setup.py
├── src/
├── tests/
├── docs/
├── LICENSE
├── CHANGELOG
└── README
```

]

---
# Exercises

1. Look at the package structure for the `r fontawesome::fa("r-project")` package [tidyr](https://github.com/tidyverse/tidyr/)
   - Do all the files exist that were discussed in this module?
   - Take a quick glance at each of the files discussed in this section.
   - What additional files are present?

2. Look at the package structure for the `r fontawesome::fa("python")` package [pytest](https://github.com/pytest-dev/pytest)
   - Do all the files exist that were discussed in this module?
   - Take a quick glance at each of the files discussed in this section.
   - What additional files are present?
